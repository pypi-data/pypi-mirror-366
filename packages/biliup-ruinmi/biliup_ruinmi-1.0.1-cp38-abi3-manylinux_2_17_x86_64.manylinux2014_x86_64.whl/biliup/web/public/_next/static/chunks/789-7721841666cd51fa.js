(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[789],{35901:function(e,t,r){"use strict";r.d(t,{H:function(){return n},a:function(){return l}});var s=r(57437),i=r(2265),a=r(99376);let o=(0,i.createContext)(void 0);function n(e){let{children:t}=e,[r,n]=(0,i.useState)(!1),l=(0,a.useRouter)();(0,i.useEffect)(()=>{let e=localStorage.getItem("auth");e?c(e).then(e=>{n(e),e||localStorage.removeItem("auth")}):d().then(e=>{e||n(!0)})},[]);let d=async()=>{try{let e=await fetch("/api/basic",{headers:{Authorization:"Basic dGVzdDp0ZXN0"}});return 401===e.status}catch(e){return!0}},c=async e=>{try{return(await fetch("/api/basic",{headers:{Authorization:"Basic ".concat(e)}})).ok}catch(e){return!1}},u=async(e,t)=>{try{let r=btoa("".concat(e,":").concat(t));if(await c(r))return localStorage.setItem("auth",r),n(!0),!0;return!1}catch(e){return!1}};return(0,s.jsx)(o.Provider,{value:{isAuthenticated:r,login:u,logout:()=>{localStorage.removeItem("auth"),n(!1),d().then(e=>{e?l.push("/login"):l.push("/")})}},children:t})}function l(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},34595:function(e,t,r){"use strict";r.d(t,{a:function(){return l}});var s=r(57437),i=r(35901),a=r(99376),o=r(2265),n=r(76301);function l(e){let{children:t}=e,{isAuthenticated:r}=(0,i.a)(),l=(0,a.useRouter)(),[d,c]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{r?c(!0):fetch("/api/basic",{headers:{Authorization:"Basic dGVzdDp0ZXN0"}}).then(e=>{401!==e.status?c(!0):l.push("/login")}).catch(()=>{l.push("/login")})},[r,l]),(r||d)&&d)?(0,s.jsx)(s.Fragment,{children:t}):r||d?null:(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,s.jsx)(n.yC,{size:"large"})})}},61255:function(e,t,r){"use strict";r.d(t,{Z:function(){return Z}});var s=r(57437),i=r(2265),a=r(99376),o=r(27648),n=r(76301),l=r(64711),d=r(9247),c=r(67050),u=r(20604),m=r(94731),h=r(67489),x=r(70787),g=r(42337),f=r(9083),b=r(24994),y=r(33145),p=r(66613),v=r(54197),j=r(62642),w=e=>{let[t,r]=(0,i.useState)(!1),[a,o]=(0,i.useState)((0,s.jsx)(p.Z,{size:"large"}));return(0,i.useEffect)(()=>{if(!0===t){let t=document.body,s=e.mode,i=s;switch(s){case"auto":i="light";break;case"light":i="dark";break;default:i="auto"}t.removeAttribute("theme-mode"),"auto"===i?t.setAttribute("theme-mode",e.systemTheme):t.setAttribute("theme-mode",i),e.setMode(i),r(!1)}switch(e.mode){case"light":o((0,s.jsx)(v.Z,{size:"large"}));break;case"dark":o((0,s.jsx)(j.Z,{size:"large"}));break;default:o((0,s.jsx)(p.Z,{size:"large"}))}},[e,t]),(0,s.jsx)(n.zx,{onClick:()=>{r(!0)},theme:"borderless",icon:a,style:{color:"var(--semi-color-text-2)"}})},k=r(36699),z=r(50196),C=r(76777),K=r.n(C);function Z(e){let{children:t}=e,{Sider:r}=l.Layout,p=(0,a.usePathname)(),v=[];("streamers"===p.slice(1)||"history"===p.slice(1))&&(v=["manager"]);let[j,C]=(0,i.useState)(v),[Z,L]=(0,i.useState)([p.slice(1)]),{width:S}=(0,z.Z)(),[E,A]=(0,i.useState)(S<=640),[I,R]=(0,i.useState)(localStorage.getItem("mode")||"auto"),N=(0,k.K4)();(0,k.Fg)(I,N);let _=E?{height:"100%",overflow:"visible"}:{height:"100%"};(0,i.useEffect)(()=>{S<=640&&A(!0)},[S]);let B=(0,i.useMemo)(()=>[{itemKey:"home",text:"主页",icon:(0,s.jsx)("div",{style:{backgroundColor:"#ffaa00ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,s.jsx)(d.Z,{size:"small"})})},{itemKey:"manager",text:"录播管理",items:[{itemKey:"streamers",text:"直播管理"},{itemKey:"history",text:"历史记录"}],icon:(0,s.jsx)("div",{style:{backgroundColor:"#5ac262ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,s.jsx)(c.Z,{size:"small"})})},{itemKey:"upload-manager",text:"投稿管理",icon:(0,s.jsx)("div",{style:{backgroundColor:"#885bd2ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,s.jsx)(u.Z,{size:"small"})})},{itemKey:"dashboard",text:"空间配置",icon:(0,s.jsx)("div",{style:{backgroundColor:"#6b6c75ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,s.jsx)(m.Z,{size:"small"})})},{itemKey:"job",text:"直播历史",icon:(0,s.jsx)("div",{style:{backgroundColor:"rgb(250 102 76)",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,s.jsx)(h.Z,{size:"small"})})},{text:"实时日志",icon:(0,s.jsx)("div",{style:{backgroundColor:"rgba(var(--semi-blue-4), 1)",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,s.jsx)(x.Z,{size:"small"})}),itemKey:"logViewer"},{text:"任务平台",icon:(0,s.jsx)("div",{style:{backgroundColor:"rgba(var(--semi-lime-2), 1)",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,s.jsx)(g.Z,{size:"small"})}),itemKey:"status"}].map(e=>(e.text=(0,s.jsx)("div",{style:{color:Z.some(t=>e.itemKey===t)||Z.some(e=>j.some(t=>{var r;return null===(r=({manager:["streamers","history"]})[t])||void 0===r?void 0:r.includes(e)}))&&j.some(t=>e.itemKey===t)?"var(--semi-color-text-0)":"var(--semi-color-text-2)",fontWeight:600},children:e.text}),e)),[j,Z]),D=(0,i.useCallback)(e=>{let{itemElement:t,isSubNav:r,isInSubNav:i,props:a}=e,n={home:"/",history:"/history",dashboard:"/dashboard",streamers:"/streamers","upload-manager":"/upload-manager",job:"/job",status:"/status",logViewer:"/logviewer"};return n[a.itemKey]?(0,s.jsx)(o.default,{style:{textDecoration:"none",fontWeight:"600 !important"},href:n[a.itemKey],children:t}):t},[]),M=(0,i.useCallback)(()=>{A(!E)},[E]);return(0,s.jsxs)(l.Layout,{className:"components-layout-demo semi-light-scrollbar",children:[(0,s.jsx)(r,{children:(0,s.jsxs)(n.JL,{style:_,openKeys:j,selectedKeys:Z,isCollapsed:E,renderWrapper:D,items:B,onOpenChange:e=>{C([...e.openKeys])},onSelect:e=>{L([...e.selectedKeys])},children:[(0,s.jsx)(n.JL.Header,{logo:(0,s.jsx)(y.default,{src:"/logo.png",alt:"{}",height:10,width:20}),style:E?{flexDirection:"column",paddingLeft:0,paddingRight:0,paddingBottom:0,gap:"8px"}:{justifyContent:"flex-start"},text:"BILIUP",children:(0,s.jsx)("div",{style:{flexGrow:1,display:S<=640?"none":"flex",flexDirection:"row-reverse",zIndex:2},children:(0,s.jsx)(n.zx,{onClick:M,type:"tertiary",className:K().shadow,theme:"borderless",icon:E?(0,s.jsx)(f.Z,{}):(0,s.jsx)(b.Z,{})})})}),(0,s.jsx)(n.JL.Footer,{collapseButton:!1,children:(0,s.jsx)(w,{mode:I,setMode:R,systemTheme:N})})]})}),(0,s.jsx)(l.Layout,{style:{height:"100vh"},children:t})]})}},36699:function(e,t,r){"use strict";r.d(t,{Fg:function(){return l},K4:function(){return n},cE:function(){return o},f:function(){return i},ql:function(){return a}});var s=r(2265);let i={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"},a=(e,t)=>{let{match:r,unmatch:s,callInInit:i=!0}=t;{let t=window.matchMedia(e),a=function(e){e.matches?r&&r(e):s&&s(e)};return(i&&a(t),Object.prototype.hasOwnProperty.call(t,"addEventListener"))?(t.addEventListener("change",a),()=>t.removeEventListener("change",a)):(t.addListener(a),()=>t.removeListener(a))}},o=e=>new Date(1e3*e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replaceAll("/","-"),n=()=>{let[e,t]=(0,s.useState)("light");return(0,s.useEffect)(()=>{let e=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t(e);let r=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>t(e);return r.addEventListener("change",s),()=>r.removeEventListener("change",s)},[]),e},l=(e,t)=>{(0,s.useEffect)(()=>{switch(localStorage.setItem("mode",e),e){case"light":document.body.setAttribute("theme-mode","light");break;case"dark":document.body.setAttribute("theme-mode","dark");break;default:document.body.setAttribute("theme-mode",t)}},[e,t])}},76777:function(e){e.exports={shadow:"page_shadow__LmobZ"}}}]);