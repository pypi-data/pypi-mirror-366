"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["12826"],{84447:function(e,t,i){i(26847),i(87799),i(27530);var a=i(73742),o=i(27885),r=i(67522),s=i(23533),n=i(7046),l=i(59048),c=i(7616);let d,h,u,p,v=e=>e;class f extends o.g{renderOutline(){return this.filled?(0,l.dy)(d||(d=v`<span class="filled"></span>`)):super.renderOutline()}getContainerClasses(){return Object.assign(Object.assign({},super.getContainerClasses()),{},{active:this.active})}renderPrimaryContent(){return(0,l.dy)(h||(h=v` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}renderTrailingIcon(){return(0,l.dy)(u||(u=v`<slot name="trailing-icon"></slot>`))}constructor(...e){super(...e),this.filled=!1,this.active=!1}}f.styles=[s.W,n.W,r.W,(0,l.iv)(p||(p=v`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,a.__decorate)([(0,c.Cb)({type:Boolean,reflect:!0})],f.prototype,"filled",void 0),(0,a.__decorate)([(0,c.Cb)({type:Boolean})],f.prototype,"active",void 0),f=(0,a.__decorate)([(0,c.Mo)("ha-assist-chip")],f)},14159:function(e,t,i){i.d(t,{Dm:function(){return s},jg:function(){return o},pN:function(){return r},xC:function(){return a}});i(6988),i(70820),i(56303);const a=e=>{let t=e;return"string"==typeof e&&(t=parseInt(e,16)),"0x"+t.toString(16).padStart(4,"0")},o=(e,t)=>{const i=e.user_given_name?e.user_given_name:e.name,a=t.user_given_name?t.user_given_name:t.name;return i.localeCompare(a)},r=(e,t)=>{const i=e.name,a=t.name;return i.localeCompare(a)},s=e=>`${e.name} (Endpoint id: ${e.endpoint_id}, Id: ${a(e.id)}, Type: ${e.type})`},83366:function(e,t,i){i.a(e,async function(e,a){try{i.r(t),i.d(t,{ZHANetworkVisualizationPage:function(){return _}});i(39710),i(26847),i(2394),i(18574),i(81738),i(29981),i(22960),i(87799),i(70820),i(1455),i(64455),i(6202),i(27530);var o=i(73742),r=i(59048),s=i(7616),n=i(67050),l=i(80634),c=i(68986),d=(i(92622),i(41668)),h=i(14159),u=i(87106),p=e([l,u]);[l,u]=p.then?(await p)():p;let v,f,y=e=>e;const g="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z";class _ extends r.oi{firstUpdated(e){super.firstUpdated(e),this.hass&&this._fetchData()}render(){return(0,r.dy)(v||(v=y` <hass-tabs-subpage .tabs="${0}" .hass="${0}" .narrow="${0}" .isWide="${0}" .route="${0}" header="${0}"> <ha-network-graph .hass="${0}" .data="${0}" .tooltipFormatter="${0}" @chart-click="${0}"> <ha-icon-button slot="button" class="refresh-button" .path="${0}" @click="${0}" label="${0}"></ha-icon-button> </ha-network-graph> </hass-tabs-subpage> `),u.zhaTabs,this.hass,this.narrow,this.isWide,this.route,this.hass.localize("ui.panel.config.zha.visualization.header"),this.hass,this._networkData,this._tooltipFormatter,this._handleChartClick,g,this._refreshTopology,this.hass.localize("ui.panel.config.zha.visualization.refresh_topology"))}async _fetchData(){this._devices=await(0,c.LO)(this.hass),this._networkData=this._createChartData(this._devices)}async _refreshTopology(){await(0,c.f3)(this.hass),await this._fetchData()}_handleChartClick(e){if("node"===e.detail.dataType&&"pointer"===e.detail.event.target.cursor){const{id:t}=e.detail.data,i=this._devices.find(e=>e.ieee===t);i&&(0,n.c)(`/config/devices/device/${i.device_reg_id}`)}}static get styles(){return[(0,r.iv)(f||(f=y`ha-network-graph{height:100%}`))]}_createChartData(e){const t=d.VQ["primary-color"],i=d.VQ["cyan-color"],a=d.VQ["teal-color"],o=d.VQ["error-color"],r=[],s=[],n=[{name:this.hass.localize("ui.panel.config.zha.visualization.coordinator"),symbol:"roundRect",itemStyle:{color:t}},{name:this.hass.localize("ui.panel.config.zha.visualization.router"),symbol:"circle",itemStyle:{color:i}},{name:this.hass.localize("ui.panel.config.zha.visualization.end_device"),symbol:"circle",itemStyle:{color:a}},{name:this.hass.localize("ui.panel.config.zha.visualization.offline"),symbol:"circle",itemStyle:{color:o}}];return e.forEach(n=>{const l="Coordinator"===n.device_type;let c;c=n.available?l?0:"Router"===n.device_type?1:2:3,r.push({id:n.ieee,name:n.user_given_name||n.name||n.ieee,category:c,value:l?3:"Router"===n.device_type?2:1,symbolSize:l?40:"Router"===n.device_type?30:20,symbol:l?"roundRect":"circle",itemStyle:{color:n.available?l?t:"Router"===n.device_type?i:a:o},polarDistance:0===c?0:1===c?.5:.9,fixed:l});const h=s.filter(e=>e.source===n.ieee||e.target===n.ieee);if(n.routes&&n.routes.length>0)n.routes.forEach(e=>{const i=n.neighbors.find(t=>t.nwk===e.next_hop);if(!i)return;const a=h.find(e=>e.source===i.ieee||e.target===i.ieee);if(a){var o;if(a.source===n.ieee)a.value=Math.max(a.value,parseInt(i.lqi));else a.reverseValue=Math.max(null!==(o=a.reverseValue)&&void 0!==o?o:0,parseInt(i.lqi));const r=this._getLQIWidth(parseInt(i.lqi));a.symbolSize=r/4*6+3,a.lineStyle=Object.assign(Object.assign({},a.lineStyle),{},{width:r,color:"Active"===e.route_status?t:a.lineStyle.color,type:["Child","Parent"].includes(i.relationship)?"solid":a.lineStyle.type})}else{const a=this._getLQIWidth(parseInt(i.lqi)),o={source:n.ieee,target:i.ieee,value:parseInt(i.lqi),lineStyle:{width:a,color:"Active"===e.route_status?t:d.VQ["disabled-color"],type:["Child","Parent"].includes(i.relationship)?"solid":"dotted"},symbolSize:a/4*6+3,ignoreForceLayout:"0x0000"!==e.dest_nwk};s.push(o),h.push(o)}});else if(0===h.length){var u;const t=null!==(u=n.neighbors)&&void 0!==u?u:[];0===t.length&&e.forEach(e=>{if(e.neighbors&&e.neighbors.length>0){const i=e.neighbors.find(e=>e.ieee===n.ieee);i&&t.push({ieee:e.ieee,lqi:i.lqi})}});const i=t.sort((e,t)=>parseInt(t.lqi)-parseInt(e.lqi))[0];i&&s.push({source:n.ieee,target:i.ieee,value:parseInt(i.lqi),symbolSize:5,lineStyle:{width:1,color:d.VQ["disabled-color"],type:"dotted"},ignoreForceLayout:!0})}}),e.forEach(e=>{if("Coordinator"===e.device_type)s.forEach(t=>{t.source!==e.ieee&&t.target!==e.ieee||(t.ignoreForceLayout=!1)});else{let t;!s.some(i=>{if(i.source===e.ieee||i.target===e.ieee){var a,o;if(!i.ignoreForceLayout)return!0;i.value>(null!==(a=null===(o=t)||void 0===o?void 0:o.value)&&void 0!==a?a:-1)&&(t=i)}return!1})&&t&&(t.ignoreForceLayout=!1)}}),{nodes:r,links:s,categories:n}}_getLQIWidth(e){return e>200?3:e>100?2:1}constructor(...e){super(...e),this.narrow=!1,this.isWide=!1,this._networkData={nodes:[],links:[],categories:[]},this._devices=[],this._tooltipFormatter=e=>{const{dataType:t,data:i,name:a}=e;if("edge"===t){var o;const{source:e,target:t,value:a}=i,r=this._networkData.nodes.find(e=>e.id===t).name,s=this._networkData.nodes.find(t=>t.id===e).name,n=`${s} → ${r}${a?` <b>LQI:</b> ${a}`:""}`,l=null===(o=this._networkData.links.find(i=>i.source===e&&i.target===t))||void 0===o?void 0:o.reverseValue;return l?`${n}<br>${r} → ${s} <b>LQI:</b> ${l}`:n}const r=this._devices.find(e=>e.ieee===i.id);if(!r)return a;let s=`<b>IEEE: </b>${r.ieee}`;if(s+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.device_type")}: </b>${r.device_type.replace("_"," ")}`,null!=r.nwk&&(s+=`<br><b>NWK: </b>${(0,h.xC)(r.nwk)}`),null!=r.manufacturer&&null!=r.model?s+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.device")}: </b>${r.manufacturer} ${r.model}`:s+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.device_not_in_db")}</b>`,r.area_id){const e=this.hass.areas[r.area_id];e&&(s+=`<br><b>${this.hass.localize("ui.panel.config.zha.visualization.area")}: </b>${e.name}`)}return s}}}(0,o.__decorate)([(0,s.Cb)({attribute:!1})],_.prototype,"hass",void 0),(0,o.__decorate)([(0,s.Cb)({attribute:!1})],_.prototype,"route",void 0),(0,o.__decorate)([(0,s.Cb)({type:Boolean,reflect:!0})],_.prototype,"narrow",void 0),(0,o.__decorate)([(0,s.Cb)({attribute:"is-wide",type:Boolean})],_.prototype,"isWide",void 0),(0,o.__decorate)([(0,s.SB)()],_.prototype,"_networkData",void 0),(0,o.__decorate)([(0,s.SB)()],_.prototype,"_devices",void 0),_=(0,o.__decorate)([(0,s.Mo)("zha-network-visualization-page")],_),a()}catch(v){a(v)}})},83788:function(e,t,i){i.a(e,async function(e,t){try{i(26847),i(1455),i(27530);"function"!=typeof window.ResizeObserver&&(window.ResizeObserver=(await i.e("89931").then(i.bind(i,11860))).default),t()}catch(a){t(a)}},1)}}]);
//# sourceMappingURL=12826.bce029a947c18b80.js.map