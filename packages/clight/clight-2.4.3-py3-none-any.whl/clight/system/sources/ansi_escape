\x1B  # ESC
(?:
  \[ [0-?]* [ -/]* [@-~]    # CSI
| \] [^\x07\x1B]* (?:\x07|\x1B\\)  # OSC
| P  .*?  \x1B\\            # DCS
| X  .*?  \x1B\\            # SOS
| \^ .*?  \x1B\\            # PM
| _  .*?  \x1B\\            # APC
)