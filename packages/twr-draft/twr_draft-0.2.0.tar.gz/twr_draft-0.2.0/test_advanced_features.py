#!/usr/bin/env python3
"""
æµ‹è¯•TWR Draft MCPæœåŠ¡å™¨çš„é«˜çº§åŠŸèƒ½ï¼ˆåˆ†ç±»å’Œæ ‡ç­¾ï¼‰- å†…å­˜å­˜å‚¨ç‰ˆæœ¬
"""

from draft_server.draft import (
    _new_draft, _get_draft, _update_draft, _delete_draft, 
    _list_drafts, _search_drafts, _get_draft_info,
    _list_categories, _list_tags, _get_drafts_by_category, _get_drafts_by_tag,
    _clear_all_drafts, _get_draft_count
)

def test_advanced_features():
    """æµ‹è¯•è‰ç¨¿æœåŠ¡å™¨çš„é«˜çº§åŠŸèƒ½"""
    
    try:
        print("ğŸ§ª å¼€å§‹æµ‹è¯•TWR Draft MCPæœåŠ¡å™¨é«˜çº§åŠŸèƒ½ï¼ˆå†…å­˜å­˜å‚¨ç‰ˆæœ¬ï¼‰...")
        
        # æ¸…ç©ºä¹‹å‰çš„æµ‹è¯•æ•°æ®
        print("\n0. æ¸…ç©ºä¹‹å‰çš„æµ‹è¯•æ•°æ®...")
        _clear_all_drafts()
        
        # æµ‹è¯•1: åˆ›å»ºå¸¦åˆ†ç±»å’Œæ ‡ç­¾çš„è‰ç¨¿
        print("\n1. æµ‹è¯•åˆ›å»ºå¸¦åˆ†ç±»å’Œæ ‡ç­¾çš„è‰ç¨¿...")
        result = _new_draft("é¡¹ç›®è®¡åˆ’", "è¿™æ˜¯ä¸€ä¸ªæ–°é¡¹ç›®çš„è¯¦ç»†è®¡åˆ’", "é¡¹ç›®", "è®¡åˆ’,é‡è¦")
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•2: åˆ›å»ºæ›´å¤šä¸åŒåˆ†ç±»çš„è‰ç¨¿
        print("\n2. æµ‹è¯•åˆ›å»ºæ›´å¤šä¸åŒåˆ†ç±»çš„è‰ç¨¿...")
        _new_draft("ä¼šè®®è®°å½•", "ä»Šå¤©å›¢é˜Ÿä¼šè®®çš„é‡è¦è®°å½•", "ä¼šè®®", "è®°å½•,å›¢é˜Ÿ")
        _new_draft("æŠ€æœ¯ç¬”è®°", "å…³äºæ–°æŠ€æœ¯çš„ç¬”è®°", "æŠ€æœ¯", "ç¬”è®°,å­¦ä¹ ")
        _new_draft("ä¸ªäººæƒ³æ³•", "ä¸€äº›ä¸ªäººæƒ³æ³•å’Œçµæ„Ÿ", "ä¸ªäºº", "æƒ³æ³•,çµæ„Ÿ")
        print("   åˆ›å»ºäº†3ä¸ªæ–°è‰ç¨¿")
        
        # æµ‹è¯•3: è·å–è‰ç¨¿æ€»æ•°
        print("\n3. æµ‹è¯•è·å–è‰ç¨¿æ€»æ•°...")
        result = _get_draft_count()
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•4: åˆ—å‡ºæ‰€æœ‰è‰ç¨¿ï¼ˆåº”è¯¥æ˜¾ç¤ºåˆ†ç±»å’Œæ ‡ç­¾ï¼‰
        print("\n4. æµ‹è¯•åˆ—å‡ºæ‰€æœ‰è‰ç¨¿...")
        result = _list_drafts()
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•5: åˆ—å‡ºæ‰€æœ‰åˆ†ç±»
        print("\n5. æµ‹è¯•åˆ—å‡ºæ‰€æœ‰åˆ†ç±»...")
        result = _list_categories()
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•6: åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾
        print("\n6. æµ‹è¯•åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾...")
        result = _list_tags()
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•7: æŒ‰åˆ†ç±»è·å–è‰ç¨¿
        print("\n7. æµ‹è¯•æŒ‰åˆ†ç±»è·å–è‰ç¨¿...")
        result = _get_drafts_by_category("é¡¹ç›®")
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•8: æŒ‰æ ‡ç­¾è·å–è‰ç¨¿
        print("\n8. æµ‹è¯•æŒ‰æ ‡ç­¾è·å–è‰ç¨¿...")
        result = _get_drafts_by_tag("é‡è¦")
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•9: æœç´¢åŠŸèƒ½ï¼ˆåº”è¯¥èƒ½æœç´¢åˆ†ç±»å’Œæ ‡ç­¾ï¼‰
        print("\n9. æµ‹è¯•æœç´¢åŠŸèƒ½...")
        result = _search_drafts("æŠ€æœ¯")
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•10: æ›´æ–°è‰ç¨¿çš„åˆ†ç±»å’Œæ ‡ç­¾
        print("\n10. æµ‹è¯•æ›´æ–°è‰ç¨¿çš„åˆ†ç±»å’Œæ ‡ç­¾...")
        result = _update_draft("é¡¹ç›®è®¡åˆ’", "æ›´æ–°åçš„é¡¹ç›®è®¡åˆ’å†…å®¹", "é‡è¦é¡¹ç›®", "è®¡åˆ’,é‡è¦,ç´§æ€¥")
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•11: è·å–æ›´æ–°åçš„è‰ç¨¿ä¿¡æ¯
        print("\n11. æµ‹è¯•è·å–æ›´æ–°åçš„è‰ç¨¿ä¿¡æ¯...")
        result = _get_draft_info("é¡¹ç›®è®¡åˆ’")
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•12: éªŒè¯æ›´æ–°åçš„åˆ†ç±»å’Œæ ‡ç­¾
        print("\n12. æµ‹è¯•éªŒè¯æ›´æ–°åçš„åˆ†ç±»å’Œæ ‡ç­¾...")
        result = _get_drafts_by_category("é‡è¦é¡¹ç›®")
        print(f"   ç»“æœ: {result}")
        
        result = _get_drafts_by_tag("ç´§æ€¥")
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•13: æ¸…ç©ºæ‰€æœ‰è‰ç¨¿
        print("\n13. æµ‹è¯•æ¸…ç©ºæ‰€æœ‰è‰ç¨¿...")
        result = _clear_all_drafts()
        print(f"   ç»“æœ: {result}")
        
        # æµ‹è¯•14: éªŒè¯æ¸…ç©ºç»“æœ
        print("\n14. éªŒè¯æ¸…ç©ºç»“æœ...")
        result = _get_draft_count()
        print(f"   ç»“æœ: {result}")
        
        print("\nâœ… æ‰€æœ‰é«˜çº§åŠŸèƒ½æµ‹è¯•å®Œæˆï¼")
        
    except Exception as e:
        print(f"\nâŒ æµ‹è¯•è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯: {e}")
        raise

if __name__ == "__main__":
    test_advanced_features() 