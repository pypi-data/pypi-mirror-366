release-date = "2025-01-17"

[[entries]]
id = "d86d5d47-3d02-4321-94a3-bea25c512ecc"
type = "breaking change"
description = "Recognize `nyl.io/default-namespace: \"true\"` on Namespace resources to choose between one of multiple namespaces defined in the same manifest file."
author = "@NiklasRosenstein"

[[entries]]
id = "056ab3d5-fc80-449c-af24-d7bca6f3e522"
type = "breaking change"
description = "Instead of not assuming a default namespace when multiple `Namespace` resources are defined in a manifest file, pick the first one alphabetically when none have the `nyl.io/default-namespace: \"true\"` annotation"
author = "@NiklasRosenstein"

[[entries]]
id = "d0798272-7c1c-402d-8e04-d578cea6a410"
type = "improvement"
description = "Apply Nyl `PostProcessor` instructions at the end, after Nyl had a chance to fill in the manifest file's determined default namespace. Kyverno might add the `namespace: default` field to any resource that has no namespace set, making it impossbile for Nyl after the fact to tell which resources need to have their namespace injected."
author = "@NiklasRosenstein"

[[entries]]
id = "8a3b94a4-0dd9-45a0-8cb2-bd679979527e"
type = "fix"
description = "Update `PostProcessor`, pointing Kyverno to a directory and expecting it to output all manifest, not just the mutated ones. The `PostProcessor` is now invoked at the very end, even after Nyl patches resources with the default namespace in the current manifest file."
author = "@NiklasRosenstein"

[[entries]]
id = "843a3744-7e50-49d3-8dc5-8800e866ca01"
type = "fix"
description = "fix #57 -- `ARGOCD_APP_NAMESPACE` and the `--default-namespace` option are used now only when no namespace is defined in the manifest file"
author = "@NiklasRosenstein"

[[entries]]
id = "3152517a-b701-4d38-ba18-f97f2f03cd09"
type = "improvement"
description = "Resources generated by the Nyl `HelmChart` resource now get the chart resource's `metadata.namespace` populated before they are passed up and inlined into the rest of the manifest. Fixes #56"
author = "@NiklasRosenstein"

[[entries]]
id = "cdbd2567-9801-4514-8552-6fdc352a8185"
type = "improvement"
description = "Fix deprecation warnings of using the `loguru.logger.opt(ansi)` keyword argument and use the new `colors` kwarg instead"
author = "@NiklasRosenstein"

[[entries]]
id = "dd1038ab-19cf-406a-bc06-ccc14ad8fbbb"
type = "feature"
description = "Add `PostProcessor.spec.kyvernoRules` field as a shorthand for defining Kyverno policies in a Nyl manifest."
author = "@NiklasRosenstein"

[[entries]]
id = "2eed140a-4d16-448a-96fb-997b3ca81297"
type = "refactor"
description = "Refactor `PostProcessor` implementation for generating policy files and invoking Kyverno"
author = "@NiklasRosenstein"

[[entries]]
id = "320c1dce-1ba6-451b-9f25-a279ae8b9eb2"
type = "improvement"
description = "`PostProcessor` log for invoking Kyverno now lists the policy file paths that are going to be applied"
author = "@NiklasRosenstein"

[[entries]]
id = "138bdc5d-848b-45fe-a5f4-4c658535339d"
type = "fix"
description = "`nyl new chart` now generates 2-space indented YAML and has a more complete template"
author = "@NiklasRosenstein"
issues = [
    "https://github.com/NiklasRosenstein/nyl/issues/47",
]
