########################################
#
# ec-frame default configuration
#
########################################
#
# configuration file name
ConfName="current.conf"
#
# input data file names (no default)
RawDir="in" # directory where to find data files
# space-separated list of files in RAwDir (or glob patterns)
RawFormat=toa5
RawFastData="*ts*"
RawSlowData="*rpv*"
#
# averaging intervals
AvgInterval=1800 # averaging interval in s
PlfitInterval=7 # planar-fit interval in days
#
# time period to process (empty string = automatic)
DateBegin="" # YYYY/MM/DD hh:mm:ss
DateEnd="" # YYYY/MM/DD hh:mm:ss
#
# output files
OutDir="out" # directory where the output will be written
FluxName="ec-flux.dat"
QCOutName="qc-flux.dat"
#
#---------------------------------------
#  format of input files
#  (order of columns)
#---------------------------------------
#
fastfmt.U_col       =3
fastfmt.V_col       =4
fastfmt.W_col       =5
fastfmt.Tsonic_col  =8
fastfmt.Tcouple_col =0
fastfmt.Humidity_col=7
fastfmt.CO2_col     =6
fastfmt.Press_col   =9
fastfmt.diag_col    =10
fastfmt.agc_col     =11
#
fastfmt.U_nam       =
fastfmt.V_nam       =
fastfmt.W_nam       =
fastfmt.Tsonic_nam  =
fastfmt.Tcouple_nam =
fastfmt.Humidity_nam=
fastfmt.CO2_nam     =
fastfmt.Press_nam   =
fastfmt.diag_nam    =
fastfmt.agc_nam     =
#
slowfmt.Tref_col    =3
slowfmt.RelHum_col  =4
slowfmt.Pref_col    =6
#
slowfmt.Tref_nam    =
slowfmt.RelHum_nam  =
slowfmt.Pref_nam    =
#
#---------------------------------------
#  internal settings
#---------------------------------------
#
# parallel processing (auto)
nproc=0
#
# directories
ExeDir=
DatDir="work"
Parmdir="."
#
# file names
ec_pre="ec_pre"
ec_fit="planang"
ec_calc="ec_ncdf"
ec_post="ec_post"
PlfIntName="inter-plfit.dat"
InterName="inter-ec.dat"
PlfName="planang.dat"
#
# netcdf variable names
U_var="Ux"
V_var="Uy"
W_var="Uz"
Tsonic_var="Ts"
Tcouple_var="Tcoup"
Humidity_var="h2o"
CO2_var="co2"
Press_var="Press"
Hourmin_var="hour_min"
Doy_var="doy"
sec_var="sec"
year_var="year"
diag_var="diag_csat"
agc_var="diag_irga"
#
#
#QCdisable = spk res drp lim mom dis nst lag chr mad fws cot bet vst ftu srv cmx & mnw itc exs fkm exe
QCdisable = fkm
#PreOutFormat = NetCDF TOA5
PreOutFormat =
Despiking = mad
#Qflags="Campbell noirga"
Qflags =
InstLatLon =
SourceArea =
Displacement =
ExcludeSector =
#
#---------------------------------------
# preprocessor setting
#---------------------------------------
#
# slow reference consitency limits
qcconf.limrrfl   = 0.
qcconf.limrrfh   = 100.
qcconf.limrtcl   = -30.
qcconf.limrtch   = 50.
qcconf.limrppl   = 750.
qcconf.limrpph   = 1100.
# instrument flags
qcconf.csatmask  = 61440 # bits that must me lo
qcconf.irgamask  = 240   # bits that must be hi
qcconf.agclimit  = 70.   # max acceptable auto-gain control value
# 1 spikes  (using window width L1)
qcconf.L1        = 300. # in s
qcconf.spth      = 3.5  # threshold in stdev
qcconf.spin      = 0.2  # threshold increase in stdev per pass
qcconf.spco      = 3    # max consecutive values regarded as spike
qcconf.spcr      = 0.01 # acceptable fraction of spikes per interval
# 2 amplitude resolution
qcconf.widampres = 1000 # window with
qcconf.mxem      = 0.5  # acceptable fraction of empty bins in each window
# 3 dropouts
qcconf.widdropout= 1000 # window with
qcconf.maxcon1   = 0.10 # acceptable fraction of consec. values in one bin (10-90%)
qcconf.maxcon2   = 0.06 # acceptable fraction of consec. values in one bin (<10,>90%)
# 4 absolute limits
qcconf.limu      = 50.  # horizontal wind speed in m/s
qcconf.limw      = 5.   # vertical wind speed in m/s
qcconf.limtl     = -30. # minimum temperature in C
qcconf.limth     = 50.  # maximum temperature in C
qcconf.limql     = 0.   # minimum specific humidity in g/kg
qcconf.limqh     = 30.  # maximum specific humidity in g/kg
qcconf.limcl     = 30.  # minimum CO2 mixing ratio in umol/mol
qcconf.limch     = 1000.# maximum CO2 mixing ratio in umol/mol
# 5 higher moments
qcconf.maxskew_1 = 1.   # skewness treshold for soft flag
qcconf.maxskew_2 = 2.   # skewness treshold for hard flag
qcconf.minkurt_1 = 2.   # min kurtosis treshold for soft flag
qcconf.maxkurt_1 = 5.   # max kurtosis treshold for soft flag
qcconf.minkurt_2 = 1.   # min kurtosis treshold for hard flag
qcconf.maxkurt_2 = 8.   # hard kurtosis treshold for hard flag
# 7 nonstationarity
qcconf.minred    = 0.9  # min acceptable wind speed reduction (in 1)
qcconf.maxrn     = 0.5  # max acceptable wind speed change (in 1)
# 8 lag correlation
qcconf.L2        = 2.    # in s
# 9 change rate spikes
qcconf.chr_u     = 5.   # max point-to-point change in horiz. wind (m/s)
qcconf.chr_w     = 5.   # max point-to-point change in verti. wind (m/s)
qcconf.chr_t     = 5.   # max point-to-point change in Temperature (K)
qcconf.chrh2o    = 3.6  # max point-to-point change in h20 density (g/m^3)  (3.6 = 0.714 kg/m^3 *  5.E-3 mol/mol)
qcconf.chrco2    = 20.  # max point-to-point change in co2 density (mg/m^3) (20. = 1.960 kg/m^3 * 10.E-6 mol/lol)
qcconf.chrcr     = 0.01 # acceptable fraction of spikes per interval
# 10 mad spikes
qcconf.mader     = 0    # 0th derivative = use data values
qcconf.madth     = 6.5  #max median absolute deviation (mad 1.48 equals 1 sigma, 5.18= 1.48*3.5)
qcconf.madcr     = 0.01 # acceptable fraction of spikes per interval
# 11 stationariry after Foken & Wichura
qcconf.fwsub     = 6    # number of subrecords
qcconf.fwlim1    = 0.30 # max acceptable difference average-mean covariance (in 1)
qcconf.fwlim2    = 0.75 # max acceptable difference average-mean covariance (in 1)
# 12 stationarity from flux by linear trend
qcconf.cotlimit  = 0.30 # max relative difference detrended minus block-mean covariance (in 1)
# 13 Higher moments compared to beta distribution
qcconf.bettol    = 1.   # tolerance above which distrib is too leptocurtic
qcconf.betdet    = 1.   # detrend (<>0) data before calculating moments
# 14 Stationarity of variance
qcconf.vstlim    = 3.   # max relative variance change
# 15 Turbulent fraction
qcconf.Lf        = 75   # subwindow width in s
qcconf.ftmin1    = 0.7  # min turbulent fraction (soft flag)
qcconf.ftmin2    = 0.5  # min turbulent fraction (hard flag)
# 16 Surving values
qcconf.msurv1    = 0.99 # minimum survivinig data (soft flag)
qcconf.msurv2    = 0.90 # minimum survivinig data (hard flag)
#value representing nans in despiked output
qcconf.spfill    = 1    # 1=interpolate spikes; 0=set spikes nan
qcconf.outnan    = -9999.#
#
#---------------------------------------
# turbulence processor settings
#---------------------------------------
#
#
Par.DoIterate = T
Par.MaxIter = 10
#
Par.FREQ = 20.   # ! [Hz] Sample frequency datalogger
#
Par.PitchLim = 30.   # ! [degree] Limit when Mean(W) is turned to zero
Par.RollLim = 30.   # ! [degree] Limit when Cov(V,W) is turned to zero
#
Par.PreYaw = 0.   # Fixed pitch angle for known tilt-correction
Par.PrePitch = 0.   # Fixed yaw angle for known tilt-correction
Par.PreRoll = 0.   # Fixed roll angle for known tilt-correction
#
Par.LLimit = 0.85   # ! Smallest acceptable freq-response corr. factor
Par.ULimit = 1.15   # ! Largest acceptable freq-response corr. factor
#
Par.DoCrMean = T   # ! Replace mean quantities by better estimates
Par.DoDetrend = F   # ! Correct data for linear trend
Par.DoSonic = T   # ! Correct sonic temperature for humidity
Par.DoTilt = F   # ! Perform true tilt-correction with known angles
Par.DoYaw = T   # ! Turn system such that Mean(V) --> 0
Par.DoPitch = F   # ! Turn system such that Mean(W) --> 0
Par.DoRoll = F   # ! Turn System such that Cov(W,V) --> 0
Par.DoFreq = T   # ! Correct for poor frequency response
Par.DoO2 = T   # ! Correct hygrometer for oxygen-sensitivity
Par.DoWebb = T   # ! Calculate mean velocity according to Webb
Par.DoStruct = T   # ! Calculate structure coefficients
Par.StructSep = 0.15   # separation (in m) used for calculation of structure parameters
Par.DoPF = T   # Do planar fit untilting (produce angles before with planang)
Par.PFValid = 0.99   # Fraction of valid samples required to include interval in planar fit
#
Par.DoErrFiSi = T   # Calculate alternate error of covariances after Finkelstein&Sims
#
Par.DoPrint = F   # ! Skip printing intermediate results or not?
#
#---------------------------------------
# postprocessor settings
#---------------------------------------
#
# i. mean vertical wind
qcconf.wlimit1   = 0.1
qcconf.wlimit2   = 0.15
# ii. integr. turb. characteristics after Foken & Wichura
qcconf.itclim1   = 0.3
qcconf.itclim2   = 1.0
qcconf.itchmin   = 10.
# iii. excluded sector wind direction
#          set in main configuration if needed
# iv. footprint model after Kormann & Meixner
qcconf.minfoot   = 0.70
# iv. exessive error
qcconf.Herrmin   = 15.
qcconf.Herrfac   = 0.3
qcconf.Eerrmin   = 15.
qcconf.Eerrfac   = 0.3
qcconf.Cerrmin   = 6.5E-8
qcconf.Cerrfac   = 0.3
qcconf.terrmin   = 0.05
qcconf.terrfac   = 0.12
#
# flux-flag dependecies
qcconf.flag_tau = ux__lim uy__lim uz__lim ux__srvh2 uy__srvh2 uz__srvh2 ux__fws uy__fws uz__mnwi1 uz__mnwh2 ux__exs ux__itc uz__itc
qcconf.flag_h_0 = ts__lim uz__lim ts__srvh2 uz__srvh2 ts__fws uz__mnwi1 uz__mnwh2 ux__exs uz__itc
qcconf.flag_e_0 = h2o_lim uz__lim h2o_srvh2 uz__srvh2 h2o_fws uz__mnwi1 uz__mnwh2 ux__exs uz__itc
qcconf.flag_fc2 = co2_lim uz__lim co2_srvh2 uz__srvh2 co2_fws uz__mnwi1 uz__mnwh2 ux__exs uz__itc
#
qcconf.interrule = h_0ie_0 fc2ie_0
#
qcconf.kill = 2
#
#---------------------------------------
# Calibrations
#---------------------------------------
#
# external calibration files
# SonName="calib-sonic.conf"
# Coupname="calib-thermo.conf"
# HygName="calib-hygro-h2o.conf"
# CO2Name="calib-hygro-co2.conf"
#
#
SonCal.QQType = 1    # Either of the ApXXXXXX numbers
SonCal.QQIdent = 0   # True series-number of the apparatus
SonCal.QQGain = 1    # Gain in this experiment
SonCal.QQOffset = 0  # Offset in this experiment
SonCal.QQX = 0       # Absolute x-position of the focal point
SonCal.QQY = 0       # Absolute y-position of the focal point
SonCal.QQZ = 2.0     # [m] Absolute z-position of the focal point
SonCal.QQC0 = 0      # unused
SonCal.QQC1 = 0      # unused
SonCal.QQC2 = 0      # unused
SonCal.QQC3 = 0      # unused
SonCal.QQC4 = 0      # unused
SonCal.QQC5 = 0      # unused
SonCal.QQC6 = 0      # unused
SonCal.QQYaw = 0     # [degree] Yaw angle of apparatus relative to north
SonCal.QQPitch = 0   # Pitch angle
SonCal.QQRoll = 0    # Roll angle
SonCal.QQOrder = 0   # unused
SonCal.QQFunc = 0    # unused
SonCal.QQPath = 0.1  # [m] Path length over which sensor integrates
SonCal.QQTime = 0    # unused
SonCal.QQDelay = 0   # [ms] Delay of this apparatus
SonCal.QQExt1 = 0    # unused ? Factor for conversion of sonic temperature signal
SonCal.QQExt2 = 1    # unused ? Multiplication factor for sonic temperature due to path length
SonCal.QQExt3 = 0.0  # [m] distance w-u
SonCal.QQExt4 = 0.1  # [m] path length sonic T
SonCal.QQExt5 = 0    # Additional calibration coefficient
#SonCal.QQExt6 = 0    # Additional calibration coefficient
#SonCal.QQExt7 = 0    # Additional calibration coefficient
#SonCal.QQExt8 = 0    # Additional calibration coefficient
#SonCal.QQExt9 = 0    # Additional calibration coefficient
#SonCal.QQExt10 = 0   # Additional calibration coefficient (Only QQType=6)
#SonCal.QQExt11 = 0   # Additional calibration coefficient (Only QQType=6)
#
CoupCal.QQType = 2   # Either of the ApXXXXXX numbers
CoupCal.QQIdent = 0  # True series-number of the apparatus
CoupCal.QQGain = 1   # Gain in this experiment
CoupCal.QQOffset = 0 # Offset in this experiment
CoupCal.QQX = 0      # Absolute x-position of the focal point
CoupCal.QQY = 0      # Absolute y-position of the focal point
CoupCal.QQZ = 2.0    # [m] Absolute z-position of the focal point
CoupCal.QQC0 = 0     # Zeroth order coefficient of calibration
CoupCal.QQC1 = 1     # First order coefficient of calibration
CoupCal.QQC2 = 0     # Second order coefficient of calibration
CoupCal.QQC3 = 0     # Third order coefficient of calibration
CoupCal.QQC4 = 0     # Fourth order coefficient of calibration
CoupCal.QQC5 = 0     # Fifth order coefficient of calibration
CoupCal.QQC6 = 0     # Sixth order coefficient of calibration
CoupCal.QQYaw = 0    # unused
CoupCal.QQPitch = 0  # unused
CoupCal.QQRoll = 0   # unused
CoupCal.QQOrder = 1  # Order of the calibration model
CoupCal.QQFunc = 1   # Type of fitfunction
CoupCal.QQPath = 0   # unused
CoupCal.QQTime = 0   # Time constant
CoupCal.QQDelay = 0  # [ms] Delay of this apparatus
CoupCal.QQExt1 = 0   # unused
CoupCal.QQExt2 = 0   # unused
CoupCal.QQExt3 = 0   # unused
CoupCal.QQExt4 = 0   # unused
CoupCal.QQExt5 = 0   # unused
#
HygCal.QQType = 8    # Either of the ApXXXXXX numbers
HygCal.QQIdent = 0   # True series-number of the apparatus
HygCal.QQGain = 1000 # Gain in this experiment
HygCal.QQOffset = 0  # Offset in this experiment
HygCal.QQX = 0       # Absolute x-position of the focal point
HygCal.QQY = 0       # Absolute y-position of the focal point
HygCal.QQZ = 2.0     # [m] Absolute z-position of the focal point
HygCal.QQC0 = 0      # Zeroth order coefficient of calibration
HygCal.QQC1 = 1      # First order coefficient of calibration
HygCal.QQC2 = 0      # Second order coefficient of calibration
HygCal.QQC3 = 0      # Third order coefficient of calibration
HygCal.QQC4 = 0      # Fourth order coefficient of calibration
HygCal.QQC5 = 0      # Fifth order coefficient of calibration
HygCal.QQC6 = 0      # Sixth order coefficient of calibration
HygCal.QQYaw = 0     # unused
HygCal.QQPitch = 0   # unused
HygCal.QQRoll = 0    # unused
HygCal.QQOrder = 1   # Order of the calibration model
HygCal.QQFunc = 1    # Type of fitfunction
HygCal.QQPath = 0.1  # [m] Path length over which sensor integrates
HygCal.QQTime = 0    # unused
HygCal.QQDelay = 0   # [ms] Delay of this apparatus
HygCal.QQExt1 = 0    # unused
HygCal.QQExt2 = 0    # unused
HygCal.QQExt3 = 0    # unused
HygCal.QQExt4 = 0    # unused
HygCal.QQExt5 = 0    # unused
#
Co2Cal.QQType = 8    # Either of the ApXXXXXX numbers
Co2Cal.QQIdent = 0   # True series-number of the apparatus
Co2Cal.QQGain = 1000000   # Gain in this experiment
Co2Cal.QQOffset = 0  # Offset in this experiment
Co2Cal.QQX = 0       # Absolute x-position of the focal point
Co2Cal.QQY = 0       # Absolute y-position of the focal point
Co2Cal.QQZ = 2.0     # [m] Absolute z-position of the focal point
Co2Cal.QQC0 = 0      # Zeroth order coefficient of calibration
Co2Cal.QQC1 = 1      # First order coefficient of calibration
Co2Cal.QQC2 = 0      # Second order coefficient of calibration
Co2Cal.QQC3 = 0      # Third order coefficient of calibration
Co2Cal.QQC4 = 0      # Fourth order coefficient of calibration
Co2Cal.QQC5 = 0      # Fifth order coefficient of calibration
Co2Cal.QQC6 = 0      # Sixth order coefficient of calibration
Co2Cal.QQYaw = 0     # unused
Co2Cal.QQPitch = 0   # unused
Co2Cal.QQRoll = 0    # unused
Co2Cal.QQOrder = 1   # Order of the calibration model
Co2Cal.QQFunc = 1    # Type of fitfunction
Co2Cal.QQPath = 0.1  # [m] Path length over which sensor integrates
Co2Cal.QQTime = 0    # unused
Co2Cal.QQDelay = 0   # [ms] Delay of this apparatus
Co2Cal.QQExt1 = 0    # unused
Co2Cal.QQExt2 = 0    # unused
Co2Cal.QQExt3 = 0    # unused
Co2Cal.QQExt4 = 0    # unused
Co2Cal.QQExt5 = 0    # unused
#
