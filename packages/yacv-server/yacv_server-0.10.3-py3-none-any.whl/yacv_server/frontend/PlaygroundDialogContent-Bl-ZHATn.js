import{j as _e,m as be,u as we,k as ke,r as B,s as Ce,l as Ae,o as Pe,n as $,p as F,w as d,q as r,t as n,v as Ue,x as v,y as Se,z as m,A as j,C as g,D as Be,E as Te,G as x,H as _,J as Re,K as Ee,N as Ve,O as z,P as Oe,_ as W,Q as $e,R as Fe,T as Me,X as Z,Y as Ie,Z as De,$ as Ne,a0 as Le,a1 as je,a2 as ze,a3 as We,a4 as Ze,a5 as qe}from"./index-fkZnxSFx.js";import{loader as Je,VueMonacoEditor as Ge}from"@guolao/vue-monaco-editor";import*as He from"monaco-editor";import Ke from"monaco-editor/esm/vs/editor/editor.worker?worker";import Qe from"monaco-editor/esm/vs/language/json/json.worker?worker";import Xe from"monaco-editor/esm/vs/language/css/css.worker?worker";import Ye from"monaco-editor/esm/vs/language/html/html.worker?worker";import et from"monaco-editor/esm/vs/language/typescript/ts.worker?worker";import{newPyodideWorker as tt}from"./frontend/tools/pyodide-worker-api.ts";import{version as ot}from"pyodide";self.MonacoEnvironment={getWorker(e,t){return t==="json"?new Qe:t==="css"||t==="scss"||t==="less"?new Xe:t==="html"||t==="handlebars"||t==="razor"?new Ye:t==="typescript"||t==="javascript"?new et:new Ke}};function nt(){Je.config({monaco:He})}const X="3.7.7",at=X,k=typeof Buffer=="function",q=typeof TextDecoder=="function"?new TextDecoder:void 0,J=typeof TextEncoder=="function"?new TextEncoder:void 0,rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",P=Array.prototype.slice.call(rt),T=(e=>{let t={};return e.forEach((s,p)=>t[s]=p),t})(P),it=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,u=String.fromCharCode.bind(String),G=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Y=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),ee=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),te=e=>{let t,s,p,c,i="";const C=e.length%3;for(let b=0;b<e.length;){if((s=e.charCodeAt(b++))>255||(p=e.charCodeAt(b++))>255||(c=e.charCodeAt(b++))>255)throw new TypeError("invalid character found");t=s<<16|p<<8|c,i+=P[t>>18&63]+P[t>>12&63]+P[t>>6&63]+P[t&63]}return C?i.slice(0,C-3)+"===".substring(C):i},D=typeof btoa=="function"?e=>btoa(e):k?e=>Buffer.from(e,"binary").toString("base64"):te,M=k?e=>Buffer.from(e).toString("base64"):e=>{let s=[];for(let p=0,c=e.length;p<c;p+=4096)s.push(u.apply(null,e.subarray(p,p+4096)));return D(s.join(""))},R=(e,t=!1)=>t?Y(M(e)):M(e),st=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?u(192|t>>>6)+u(128|t&63):u(224|t>>>12&15)+u(128|t>>>6&63)+u(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return u(240|t>>>18&7)+u(128|t>>>12&63)+u(128|t>>>6&63)+u(128|t&63)}},lt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,oe=e=>e.replace(lt,st),H=k?e=>Buffer.from(e,"utf8").toString("base64"):J?e=>M(J.encode(e)):e=>D(oe(e)),w=(e,t=!1)=>t?Y(H(e)):H(e),K=e=>w(e,!0),dt=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ut=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),s=t-65536;return u((s>>>10)+55296)+u((s&1023)+56320);case 3:return u((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return u((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},ne=e=>e.replace(dt,ut),ae=e=>{if(e=e.replace(/\s+/g,""),!it.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,s="",p,c;for(let i=0;i<e.length;)t=T[e.charAt(i++)]<<18|T[e.charAt(i++)]<<12|(p=T[e.charAt(i++)])<<6|(c=T[e.charAt(i++)]),s+=p===64?u(t>>16&255):c===64?u(t>>16&255,t>>8&255):u(t>>16&255,t>>8&255,t&255);return s},N=typeof atob=="function"?e=>atob(ee(e)):k?e=>Buffer.from(e,"base64").toString("binary"):ae,re=k?e=>G(Buffer.from(e,"base64")):e=>G(N(e).split("").map(t=>t.charCodeAt(0))),ie=e=>re(se(e)),pt=k?e=>Buffer.from(e,"base64").toString("utf8"):q?e=>q.decode(re(e)):e=>ne(N(e)),se=e=>ee(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),I=e=>pt(se(e)),ct=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},le=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),de=function(){const e=(t,s)=>Object.defineProperty(String.prototype,t,le(s));e("fromBase64",function(){return I(this)}),e("toBase64",function(t){return w(this,t)}),e("toBase64URI",function(){return w(this,!0)}),e("toBase64URL",function(){return w(this,!0)}),e("toUint8Array",function(){return ie(this)})},ue=function(){const e=(t,s)=>Object.defineProperty(Uint8Array.prototype,t,le(s));e("toBase64",function(t){return R(this,t)}),e("toBase64URI",function(){return R(this,!0)}),e("toBase64URL",function(){return R(this,!0)})},ft=()=>{de(),ue()},mt={version:X,VERSION:at,atob:N,atobPolyfill:ae,btoa:D,btoaPolyfill:te,fromBase64:I,toBase64:w,encode:w,encodeURI:K,encodeURL:K,utob:oe,btou:ne,decode:I,isValid:ct,fromUint8Array:R,toUint8Array:ie,extendString:de,extendUint8Array:ue,extendBuiltins:ft},yt=`import micropip

# Prioritize the OCP.wasm package repository for finding the ported dependencies.
micropip.set_index_urls(["https://yeicor.github.io/OCP.wasm", "https://pypi.org/simple"])

# For build123d < 0.10.0, we need to install the mock the py-lib3mf package (before the main install).
await micropip.install("lib3mf")
micropip.add_mock_package("py-lib3mf", "2.4.1", modules={"py_lib3mf": 'from lib3mf import *'})

# Install the yacv_server package, which is the main server for the OCP.wasm playground; and also preinstalls build123d.
await micropip.install("yacv_server", pre=True)

# Preimport the yacv_server package to ensure it is available in the global scope, and mock the ocp_vscode package.
from yacv_server import *

micropip.add_mock_package("ocp-vscode", "2.8.9", modules={"ocp_vscode": 'from yacv_server import *'})
show_object = show

# Preinstall the font-fetcher package and install its hook to automatically download any requested font.
await micropip.install("font-fetcher", pre=True)

from font_fetcher.ocp import install_ocp_font_hook

install_ocp_font_hook()
`,ht={style:{display:"inline-flex","margin-right":"16px"}},vt={style:{"margin-right":"-8px"}},gt={style:{"margin-left":"-8px"}},xt={class:"playground-container"},_t={class:"playground-console"},bt={style:{display:"flex","align-items":"center","justify-content":"space-between",margin:"0"}},Q="yacv_server://model/",wt=_e({__name:"PlaygroundDialogContent",props:{modelValue:{required:!0},modelModifiers:{}},emits:be(["close","updateModel"],["update:modelValue"]),setup(e,{emit:t}){we(a=>({"2da2f359":f.value}));const s=ke(e,"modelValue"),p=t;nt();const c=B("");function i(a){c.value+=a;let o=1e4;c.value.length>o&&(c.value=c.value.slice(-o)),console.log(a),Ze(()=>{const l=document.querySelector(".playground-console");l&&(l.scrollTop=l.scrollHeight)})}const C={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0},b=window.matchMedia("(prefers-color-scheme: dark)").matches?"vs-dark":"vs",pe=Ce(),ce=a=>pe.value=a,f=B(.9);let y=null;const h=B(!0);async function L(a,o=void 0){h.value=!0,f.value==0&&!a&&(f.value=.9),y===null?(i(`Creating new Pyodide worker...
`),y=tt(Object.assign({indexURL:`https://cdn.jsdelivr.net/pyodide/v${ot}/full/`,packages:["micropip","sqlite3"]},o?{_loadSnapshot:o}:{}))):i(`Reusing existing Pyodide instance...
`),i(`Preloading packages...
`),await y.asyncRun(yt,i,i),h.value=!1,i(`Pyodide worker ready.
`)}async function E(){if(y===null){i(`Pyodide worker is not initialized. Please wait...
`);return}if(h.value){i(`Pyodide is already running. Please wait...
`);return}i(`Running code...
`);try{h.value=!0,await y.asyncRun(s.value.code,i,a=>{if(a.startsWith(Q)){const o=a.slice(Q.length);fe(o)}else i(a)})}catch(a){i(`Error running code: ${a}
`)}finally{h.value=!1}}function fe(a){i(`Model data detected... ${a.length}B
`);let o=0,l=0;for(;o<a.length&&(a[o]==="{"?l++:a[o]==="}"&&l--,l!==0);o++);if(l!==0)throw`Error: Invalid model data received: ${a}
`;const U=a.slice(0,o+1);let A=JSON.parse(U);const S=new Le(A.name,"",A.hash,A.is_remove);if(i(`Model metadata: ${JSON.stringify(S)}
`),!S.isRemove){const O=mt.toUint8Array(a.slice(o+1));console.assert(O.slice(0,4).toString()=="103,108,84,70","Invalid GLTF binary data received: "+O.slice(0,4).toString());const xe=new Blob([O],{type:"model/gltf-binary"});S.url=URL.createObjectURL(xe)}let ge=new je([S],()=>{});p("updateModel",ge)}function me(a=void 0){y&&(y.terminate(),y=null),c.value="",L(!1,a)}function ye(){const a=window.location,o=new URLSearchParams(a.search);o.delete("pg_code_url"),o.delete("pg_code");const l=new URLSearchParams(a.hash.slice(1));l.delete("pg_code_url"),l.set("pg_code",ze(We(s.value.code,{level:9})));const U=`${a.origin}${a.pathname}?${o}#${l}`;if(i(`Share link ready: ${U}
`),navigator.clipboard?.writeText===void 0){i(`Clipboard API not available. Please copy the link manually.
`);return}else navigator.clipboard.writeText(U).then(()=>i(`Link copied to clipboard!
`)).catch(A=>i(`Failed to copy link: ${A}
`))}function he(){throw new Error("Not implemented yet!")}function ve(){throw new Error("Not implemented yet!")}(async()=>{const a=await Ae;s.value.firstTime&&(f.value=a.pg_opacity_loading),await L(!0),s.value.firstTime&&(await E(),f.value=a.pg_opacity_loaded,s.value.firstTime=!1)})();const V=B(null);return Pe(()=>{V.value&&V.value.addEventListener("keydown",a=>{a instanceof KeyboardEvent&&(a.key==="F10"?(a.preventDefault(),E()):a.key==="Escape"&&p("close"))})}),(a,o)=>(F(),$(n(Ne),{class:"popup-card",style:Z(f.value==0?"position: absolute; top: calc(-50vh + 24px); width: calc(100vw - 64px);":"")},{default:d(()=>[r(n(Ue),{class:"popup"},{default:d(()=>[r(n(Se),{style:{flex:"0 1 auto"}},{default:d(()=>o[9]||(o[9]=[m("Playground",-1)])),_:1,__:[9]}),r(n(j)),v("span",ht,[r(n(g),{path:n(Be),type:"mdi",style:{height:"32px"}},null,8,["path"]),r(n(Te),{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=l=>f.value=l),max:1,min:0,step:.1,style:{width:"100px",height:"32px"}},null,8,["modelValue"]),r(n(x),{activator:"parent",location:"bottom"},{default:d(()=>o[10]||(o[10]=[m("Opacity of the editor (0 = hidden, 1 = fully visible)",-1)])),_:1,__:[10]})]),v("span",vt,[r(n(_),{icon:"",disabled:"",onClick:o[1]||(o[1]=l=>he())},{default:d(()=>[r(n(g),{path:n(Re),type:"mdi"},null,8,["path"])]),_:1}),r(n(x),{activator:"parent",location:"bottom"},{default:d(()=>o[11]||(o[11]=[m("Save current state to a snapshot for fast startup (WIP)",-1)])),_:1,__:[11]})]),v("span",gt,[r(n(_),{icon:"",disabled:"",onClick:o[2]||(o[2]=l=>ve())},{default:d(()=>[r(n(g),{path:n(Ee),type:"mdi"},null,8,["path"])]),_:1}),r(n(x),{activator:"parent",location:"bottom"},{default:d(()=>o[12]||(o[12]=[m("Load snapshot for fast startup (WIP)",-1)])),_:1,__:[12]})]),r(n(_),{icon:"",onClick:o[3]||(o[3]=l=>me())},{default:d(()=>[r(n(g),{path:n(Ve),type:"mdi"},null,8,["path"]),r(n(x),{activator:"parent",location:"bottom"},{default:d(()=>o[13]||(o[13]=[m("Reset Pyodide worker (this forgets all previous state and will take a little while) ",-1)])),_:1,__:[13]})]),_:1}),r(n(_),{icon:"",onClick:o[4]||(o[4]=l=>E()),disabled:h.value},{default:d(()=>[r(n(g),{path:n(Oe),type:"mdi"},null,8,["path"]),h.value?(F(),$(W,{key:0,style:{position:"absolute",top:"-16%",left:"-16%"}})):z("",!0),r(n(x),{activator:"parent",location:"bottom"},{default:d(()=>o[14]||(o[14]=[m("Run code",-1)])),_:1,__:[14]})]),_:1},8,["disabled"]),r(n(_),{icon:"",onClick:o[5]||(o[5]=l=>ye())},{default:d(()=>[r(n(g),{path:n($e),type:"mdi"},null,8,["path"]),r(n(x),{activator:"parent",location:"bottom"},{default:d(()=>o[15]||(o[15]=[m("Share link that auto-runs the code",-1)])),_:1,__:[15]})]),_:1}),r(n(_),{icon:"",onClick:o[6]||(o[6]=l=>p("close"))},{default:d(()=>[r(n(g),{path:n(Fe),type:"mdi"},null,8,["path"]),r(n(x),{activator:"parent",location:"bottom"},{default:d(()=>o[16]||(o[16]=[m("Close (Pyodide remains loaded)",-1)])),_:1,__:[16]})]),_:1})]),_:1}),r(n(Me),{class:"popup-card-text",style:Z(f.value==0?"display: none":"")},{default:d(()=>[v("div",xt,[v("div",{class:"playground-editor",ref_key:"editorRef",ref:V},[r(n(Ge),{value:s.value.code,"onUpdate:value":o[7]||(o[7]=l=>s.value.code=l),theme:n(b),options:C,language:"python",onMount:ce},null,8,["value","theme"])],512),v("div",_t,[v("h3",bt,[o[17]||(o[17]=m(" Console Output ",-1)),r(n(j)),r(n(_),{onClick:o[8]||(o[8]=l=>c.value="")},{default:d(()=>[r(n(g),{path:n(Ie),type:"mdi",class:"h-"},null,8,["path"])]),_:1})]),v("pre",null,De(c.value),1),h.value?(F(),$(W,{key:0})):z("",!0)])])]),_:1},8,["style"])]),_:1},8,["style"]))}}),Et=qe(wt,[["__scopeId","data-v-157a227e"]]);export{Et as default};
//# sourceMappingURL=PlaygroundDialogContent-Bl-ZHATn.js.map
