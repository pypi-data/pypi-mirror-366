import re


# åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ\b æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œè¡¨ç¤ºå•è¯è¾¹ç•Œï¼ˆword boundaryï¼‰ã€‚
# å®ƒç”¨äºåŒ¹é…å•è¯çš„å¼€å§‹æˆ–ç»“æŸä½ç½®ï¼Œè€Œä¸æ˜¯åŒ¹é…å…·ä½“çš„å­—ç¬¦ã€‚
# å…·ä½“æ¥è¯´ï¼Œ\b åŒ¹é…çš„ä½ç½®æ˜¯åœ¨å•è¯å­—ç¬¦ï¼ˆå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼‰å’Œéå•è¯å­—ç¬¦ä¹‹é—´çš„ä½ç½®ã€‚
# ä½¿ç”¨ \b å¯ä»¥ç¡®ä¿åŒ¹é…çš„æ˜¯å®Œæ•´çš„å•è¯ï¼Œè€Œä¸æ˜¯å•è¯çš„ä¸€éƒ¨åˆ†

# åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå‘å‰æ–­è¨€ï¼ˆLookaheadï¼‰ å’Œ å‘åæ–­è¨€ï¼ˆLookbehindï¼‰ æ˜¯ä¸¤ç§ç‰¹æ®Šçš„æ–­è¨€ç±»å‹ï¼Œå®ƒä»¬å…è®¸ä½ åœ¨åŒ¹é…æŸä¸ªæ¨¡å¼æ—¶ï¼Œæ£€æŸ¥å…¶å‰åæ˜¯å¦å­˜åœ¨ç‰¹å®šçš„å­æ¨¡å¼ï¼Œè€Œä¸ä¼šå°†è¿™äº›å­æ¨¡å¼åŒ…å«åœ¨æœ€ç»ˆçš„åŒ¹é…ç»“æœä¸­ã€‚è¿™ä¸¤ç§æ–­è¨€åœ¨å¤æ‚çš„æ–‡æœ¬å¤„ç†å’Œæ¨¡å¼åŒ¹é…ä¸­éå¸¸æœ‰ç”¨ã€‚
# å‘å‰æ–­è¨€ï¼ˆLookaheadï¼‰
# å‘å‰æ–­è¨€ç”¨äºæ£€æŸ¥å½“å‰ä½ç½®åé¢æ˜¯å¦åŒ¹é…æŸä¸ªæ¨¡å¼ï¼Œä½†ä¸åŒ…æ‹¬è¯¥æ¨¡å¼åœ¨æœ€ç»ˆçš„åŒ¹é…ç»“æœä¸­ã€‚å‘å‰æ–­è¨€åˆ†ä¸ºä¸¤ç§ï¼š
# æ­£å‘å‘å‰æ–­è¨€ï¼ˆPositive Lookaheadï¼‰ï¼š
# è¯­æ³•ï¼š(?=...)
# ä½œç”¨ï¼šç¡®ä¿å½“å‰ä½ç½®åé¢è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ï¼Œä½†ä¸åŒ…å«è¯¥æ¨¡å¼åœ¨åŒ¹é…ç»“æœä¸­ã€‚
# è´Ÿå‘å‘å‰æ–­è¨€ï¼ˆNegative Lookaheadï¼‰ï¼š
# è¯­æ³•ï¼š(?!...)
# ä½œç”¨ï¼šç¡®ä¿å½“å‰ä½ç½®åé¢ä¸è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ã€‚

# å‘åæ–­è¨€ï¼ˆLookbehindï¼‰
# å‘åæ–­è¨€ç”¨äºæ£€æŸ¥å½“å‰ä½ç½®å‰é¢æ˜¯å¦åŒ¹é…æŸä¸ªæ¨¡å¼ï¼Œä½†ä¸åŒ…æ‹¬è¯¥æ¨¡å¼åœ¨æœ€ç»ˆçš„åŒ¹é…ç»“æœä¸­ã€‚å‘åæ–­è¨€ä¹Ÿåˆ†ä¸ºä¸¤ç§ï¼š
# æ­£å‘å‘åæ–­è¨€ï¼ˆPositive Lookbehindï¼‰ï¼š
# è¯­æ³•ï¼š(?<=...)
# ä½œç”¨ï¼šç¡®ä¿å½“å‰ä½ç½®å‰é¢è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ï¼Œä½†ä¸åŒ…å«è¯¥æ¨¡å¼åœ¨åŒ¹é…ç»“æœä¸­ã€‚
# è´Ÿå‘å‘åæ–­è¨€ï¼ˆNegative Lookbehindï¼‰ï¼š
# è¯­æ³•ï¼š(?<!...)
# ä½œç”¨ï¼šç¡®ä¿å½“å‰ä½ç½®å‰é¢ä¸è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ã€‚

# æ³¨æ„äº‹é¡¹
# æ€§èƒ½å½±å“ï¼šæ–­è¨€æ“ä½œå¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä¸€å®šå½±å“ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§è§„æ¨¡æ–‡æœ¬æ—¶ã€‚
# å…¼å®¹æ€§ï¼šå¹¶éæ‰€æœ‰æ­£åˆ™è¡¨è¾¾å¼å¼•æ“éƒ½æ”¯æŒæ‰€æœ‰ç±»å‹çš„æ–­è¨€ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç›®æ ‡ç¯å¢ƒçš„æ”¯æŒæƒ…å†µã€‚


def str_to_pattern(pattern, flags=re.IGNORECASE) -> re.Pattern:
    """
    å³ä½¿ä½¿ç”¨äº† re.MULTILINEï¼Œmatch() ä¹Ÿä¸ä¼šæ”¹å˜è¡Œä¸ºï¼ˆä»åªåŒ¹é…å­—ç¬¦ä¸²æ•´ä½“çš„å¼€å¤´ï¼‰ã€‚
    findall() å’Œ search() é»˜è®¤æ”¯æŒè·¨è¡ŒåŒ¹é…å†…å®¹ã€‚
    å¦‚æœä½ ä½¿ç”¨äº† ^ æˆ– $ å¹¶å¸Œæœ›å®ƒä»¬ä½œç”¨äºæ¯ä¸€è¡Œï¼Œè¯·å¯ç”¨ re.MULTILINEã€‚
    è‹¥åªæ˜¯æŸ¥æ‰¾æŸæ®µæ–‡å­—ä¸­çš„å…³é”®è¯æˆ–å­ä¸²ï¼Œæ— éœ€è®¾ç½® re.MULTILINEã€‚
    ğŸ“Œ å…³äº ^ å’Œ $ çš„è¡Œä¸ºï¼ˆå…³é”®ç‚¹ï¼‰
    ä¸åŠ  re.MULTILINEï¼š
        ^ åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹ã€‚
        $ åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²çš„ç»“æŸã€‚
    åŠ ä¸Š re.MULTILINEï¼š
        ^ åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å§‹ã€‚
        $ åŒ¹é…æ¯ä¸€è¡Œçš„ç»“æŸã€‚
    """
    return re.compile(pattern, flags)


# ^ï¼šåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ã€‚
# $ï¼šåŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸã€‚
def re_begin_with(key, want_pattern=".*"):
    """
    - r"^w\w+"
    - å­—ç¬¦ä¸² "word" åŒ¹é…æˆåŠŸï¼Œæ•´ä¸ªåŒ¹é…ç»“æœä¸º "word"ã€‚
    - r"^w(\w+)"
    - å­—ç¬¦ä¸² "word" åŒ¹é…æˆåŠŸï¼Œæ•´ä¸ªåŒ¹é…ç»“æœä¸º "word"ï¼Œæ•è·ç»„å†…å®¹ä¸º "ord"ã€‚
    - result = re.search(r"^w(\w+)","world")
    - print(result.group(0)) => "word"
    - print(result.group(1)) => "ord"
    """
    return f"^{key}{want_pattern}"


def re_finish_with(key, want_pattern=".*"):
    return f"{want_pattern}{key}$"


# re.search
# åŠŸèƒ½ï¼šåœ¨å­—ç¬¦ä¸²ä¸­æœç´¢ç¬¬ä¸€ä¸ªåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„éƒ¨åˆ†ã€‚
# è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªåŒ¹é…å¯¹è±¡ï¼ˆMatchObjectï¼‰ï¼Œå¦‚æœæ‰¾ä¸åˆ°åŒ¹é…åˆ™è¿”å› Noneã€‚
# é€‚ç”¨åœºæ™¯ï¼šå½“ä½ åªéœ€è¦çŸ¥é“æ˜¯å¦å­˜åœ¨åŒ¹é…é¡¹ï¼Œæˆ–è€…åªéœ€è¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹æ—¶ä½¿ç”¨

# re.findall
# åŠŸèƒ½ï¼šåœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„éƒ¨åˆ†ã€‚
# è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰åŒ¹é…çš„å­å­—ç¬¦ä¸²ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚
# é€‚ç”¨åœºæ™¯ï¼šå½“ä½ éœ€è¦è·å–æ‰€æœ‰åŒ¹é…é¡¹æ—¶ä½¿ç”¨ã€‚
def re_findall_word(want_pattern, text):
    return re.findall(rf"\b{want_pattern}\b", text)


def re_match_between(start, want, end):
    """
    å®Œæ•´åŒ¹é…
    :param start:
    :param want:
    :param end:
    :return:
    """
    return f"^{start}({want}){end}$"


# ^ï¼šåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ã€‚
# $ï¼šåŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸã€‚
# ä¸€èµ·ç”¨ï¼Œæ˜¯åŒ¹é…å®Œæ•´å­—ç¬¦ä¸²
def re_is_between(start, end, text):
    return re.match(f"^{start}.*{end}$", text)


def re_findall_between(start, want, end, text):
    return re.findall(f"{start}{want}{end}", text)


def re_findall_between_no_include(start, want, end, text):
    """
    æŸ¥æ‰¾æ‰€æœ‰startå’Œendä¹‹é—´çš„wantå†…å®¹ï¼Œä¸åŒ…æ‹¬startå’Œend
    """
    return re.findall(f"(?<={start}){want}(?={end})", text)


# æ³¨æ„äº‹é¡¹
# æ€§èƒ½å½±å“ï¼šæ–­è¨€æ“ä½œå¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä¸€å®šå½±å“ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§è§„æ¨¡æ–‡æœ¬æ—¶ã€‚
# å…¼å®¹æ€§ï¼šå¹¶éæ‰€æœ‰æ­£åˆ™è¡¨è¾¾å¼å¼•æ“éƒ½æ”¯æŒæ‰€æœ‰ç±»å‹çš„æ–­è¨€ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç›®æ ‡ç¯å¢ƒçš„æ”¯æŒæƒ…å†µã€‚


# æ­£å‘å…ˆè¡Œæ–­è¨€æ˜¯ä¸€ç§æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ï¼Œç”¨äºåŒ¹é…ç‰¹å®šå­—ç¬¦å‰é¢ç´§è·Ÿç€çš„å†…å®¹ï¼Œä½†ä¸åŒ…æ‹¬è¿™ä¸ªå­—ç¬¦æœ¬èº«ã€‚
# æ­£å‘å…ˆè¡Œæ–­è¨€ä½¿ç”¨ (?=...) çš„æ ¼å¼æ¥è¡¨ç¤ºï¼Œå…¶ä¸­ ... æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºè¦åŒ¹é…çš„â€œå‰é¢çš„å†…å®¹â€ã€‚
# åœ¨æ­£å‘å…ˆè¡Œæ–­è¨€ä¸­ï¼Œ(?=...) ä¸­çš„ ... é€šå¸¸æ˜¯ä¸€ä¸ªåŒ¹é…åç¼€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæŒ‡å®šâ€œè¦åŒ¹é…çš„å¸¦æœ‰åç¼€çš„å†…å®¹â€ï¼Œä¾‹å¦‚ (?=abc) è¡¨ç¤ºåŒ¹é…ç´§è·Ÿç€ abc çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‹¬å·å†…çš„è¡¨è¾¾å¼ä¸ä¸Šä¸‹æ–‡è¦åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­çš„å®é™…å†…å®¹æ˜¯ä¸åŒ¹é…çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªè¡¨è¾¾å¼åªèµ·åˆ°ä¸€ä¸ªé™å®šåŒ¹é…æ¡ä»¶çš„ä½œç”¨ã€‚
# ä¾‹å¦‚ï¼Œå¯¹äºå­—ç¬¦ä¸² "hello, world"ï¼Œå¯ä»¥ä½¿ç”¨ \w+(?=, ) æ¥åŒ¹é…é€—å·å‰é¢çš„å•è¯ï¼Œè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ (?=, ) è¡¨ç¤ºåŒ¹é…ä¹‹åå¿…é¡»æœ‰é€—å·å’Œä¸€ä¸ªç©ºæ ¼ï¼Œ\w+ åˆ™è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯å­—ç¬¦ã€‚è¿™ä¸ªè¡¨è¾¾å¼çš„åŒ¹é…ç»“æœæ˜¯ "hello"ã€‚

# æ­£å‘å…ˆè¡Œæ–­è¨€ï¼ˆPositive Lookaheadï¼‰
# è¯­æ³•ï¼š(?=...)
# ä½œç”¨ï¼šåŒ¹é…æŸä¸ªä½ç½®ï¼Œè¯¥ä½ç½®åé¢è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ï¼Œä½†ä¸åŒ…æ‹¬è¯¥æ¨¡å¼æœ¬èº«ã€‚
def re_lookahead_positive(want_pattern, key_no_include):
    """
    - ç”¨äºåŒ¹é…ç‰¹å®šå­—ç¬¦å‰é¢ç´§è·Ÿç€çš„å†…å®¹ï¼Œä½†ä¸åŒ…æ‹¬è¿™ä¸ªå­—ç¬¦æœ¬èº«ã€‚
    - è¡¨ç¤ºè¦åŒ¹é…çš„â€œå‰é¢çš„å†…å®¹â€ã€‚
    :param key:
    :return:
    """
    return f"{want_pattern}(?={key_no_include})"


# è´Ÿå‘å…ˆè¡Œæ–­è¨€ï¼ˆNegative Lookaheadï¼‰
# è¯­æ³•ï¼š(?!...)
# ä½œç”¨ï¼šåŒ¹é…æŸä¸ªä½ç½®ï¼Œè¯¥ä½ç½®åé¢ä¸è·Ÿç€æŒ‡å®šçš„æ¨¡å¼
def re_lookahead_negative(want_pattern, key_no_include):
    """
    - ç”¨äºåŒ¹é…ç‰¹å®šå­—ç¬¦å‰é¢éç´§è·Ÿç€çš„å†…å®¹ï¼Œä½†ä¸åŒ…æ‹¬è¿™ä¸ªå­—ç¬¦æœ¬èº«ã€‚
    - è¡¨ç¤ºè¦åŒ¹é…çš„â€œå‰é¢çš„å†…å®¹â€ã€‚

    :param key:
    :return:
    """
    return f"{want_pattern}(?!{key_no_include})"


# æ­£å‘åè¡Œæ–­è¨€ï¼ˆPositive Lookbehindï¼‰
# è¯­æ³•ï¼š(?<=...)
# ä½œç”¨ï¼šåŒ¹é…æŸä¸ªä½ç½®ï¼Œè¯¥ä½ç½®å‰é¢è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ï¼Œä½†ä¸åŒ…æ‹¬è¯¥æ¨¡å¼æœ¬èº«ã€‚
#     """
#     - ç”¨äºåŒ¹é…ç‰¹å®šå­—ç¬¦åé¢ç´§è·Ÿç€çš„å†…å®¹ï¼Œä½†ä¸åŒ…æ‹¬è¿™ä¸ªå­—ç¬¦æœ¬èº«ã€‚
#     - è¡¨ç¤ºè¦åŒ¹é…çš„â€œåé¢çš„å†…å®¹â€ã€‚
#     - (?<=hellow}) hellow world =>world
#     :param key:
#     :return:
#     """
def re_lookbehind_positive(key_no_include, want_pattern):
    """
    - åŒ¹é… key_no_include ç´§è·Ÿç€åé¢çš„å†…å®¹ï¼Œä»€ä¹ˆå†…å®¹ç”± want_pattern åŒ¹é…
    - æƒ³è¦çš„ want_pattern å‰é¢ç´§è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ key_no_includeã€‚
    - (?<!,)\w+ => hellow,world -> ['world']
    :param want_pattern: è¦åŒ¹é…å‡ºçš„æ­£åˆ™å†…å®¹
    :param key_no_include: å…³é”®å­—ï¼ŒåŒ¹é…ç»“æœä¸åŒ…æ‹¬
    :return:
    """
    return f"(?<={key_no_include}){want_pattern}"


# è´Ÿå‘å‘åæ–­è¨€ï¼ˆNegative Lookbehindï¼‰ï¼š
# è¯­æ³•ï¼š(?<!...)
# ä½œç”¨ï¼šç¡®ä¿å½“å‰ä½ç½®å‰é¢ä¸è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ã€‚
def re_lookbehind_negative(key_no_include, want_pattern):
    """
    - åŒ¹é…ã€ä¸æ˜¯ã€‘key_no_include ç´§è·Ÿç€åé¢çš„å†…å®¹ï¼Œä»€ä¹ˆå†…å®¹ç”± want_pattern åŒ¹é…
    - æƒ³è¦çš„ want_pattern å‰é¢ä¸è·Ÿç€æŒ‡å®šçš„æ¨¡å¼ key_no_includeã€‚
    - (?<!,)\w+ => hellow, world -> ['hello', 'orld']
    :param want_pattern: è¦åŒ¹é…å‡ºçš„æ­£åˆ™å†…å®¹
    :param key_no_include: å…³é”®å­—ï¼ŒåŒ¹é…ç»“æœä¸åŒ…æ‹¬
    :return:
    """
    return rf"(?<!{key_no_include}){want_pattern}"


def test_findall(pattern, text):
    # match = re.search(pattern, text)
    # if match:
    #     print("search.group(0):", match.group(0))
    print("pattern:", pattern)
    all = re.findall(pattern, text)
    if all:
        print("findall:", all)


if __name__ == '__main__':
    #  "hello, world"ï¼Œå¯ä»¥ä½¿ç”¨ \w+(?=, )
    pattern = r'\w+(?=, )'
    text = "hello, world"
    # test_search(r"\w+(?=o)", text)
    # test_search("(?<=hellow}).*", text)
    # test_findall(lookbehind_positive(r"\w+", ","), text)
    # test_findall(lookbehind_negative(r"\w+", ","), text)
    result = re.match(re_finish_with("(log|dog)", ".*"), "git log.dog")
    print(result)
