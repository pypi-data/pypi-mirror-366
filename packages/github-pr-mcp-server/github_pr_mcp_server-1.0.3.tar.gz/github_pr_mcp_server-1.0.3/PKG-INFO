Metadata-Version: 2.4
Name: github-pr-mcp-server
Version: 1.0.3
Summary: GitHub PR MCP Server - MCP&Agent Challenge
Author-email: MCP&Agent Challenge <challenge@example.com>
License: MIT
Project-URL: Homepage, https://github.com/your-username/github-pr-mcp-server
Project-URL: Repository, https://github.com/your-username/github-pr-mcp-server
Project-URL: Documentation, https://github.com/your-username/github-pr-mcp-server#readme
Project-URL: Issues, https://github.com/your-username/github-pr-mcp-server/issues
Keywords: mcp,github,pr,webhook,ai,gradio,flask
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Internet :: WWW/HTTP :: HTTP Servers
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: gradio[mcp]==5.39.0
Requires-Dist: mcp==1.10.1
Requires-Dist: flask==3.0.3
Requires-Dist: openai==1.93.0
Requires-Dist: requests==2.32.3
Requires-Dist: python-dotenv==1.1.1
Provides-Extra: dev
Requires-Dist: pytest>=7.4.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"

# GitHub PR MCP Server - MCP&Agent Challenge

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![PyPI version](https://badge.fury.io/py/github-pr-mcp-server.svg)](https://badge.fury.io/py/github-pr-mcp-server)

## é¡¹ç›®ç®€ä»‹

GitHub PR MCP Server æ˜¯ä¸€ä¸ªåŸºäº Gradio å’Œ Flask çš„ MCPï¼ˆModel Context Protocolï¼‰æœåŠ¡å™¨ï¼Œä¸“é—¨ç”¨äºè‡ªåŠ¨åŒ–å¤„ç† GitHub Pull Request äº‹ä»¶ã€‚å½“ GitHub Webhook æ£€æµ‹åˆ° PR æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°† PR å†…å®¹è½¬å‘ç»™ AI è¿›è¡Œåˆ†æï¼Œç”Ÿæˆç»“æ„åŒ–çš„æ—¥å¿—æ‘˜è¦ï¼Œå¹¶å‘é€åˆ°é£ä¹¦çŸ¥è¯†åº“ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- **MCP åè®®æ”¯æŒ**: å®Œå…¨å…¼å®¹ MCP åè®®ï¼Œå¯ä½œä¸ºå·¥å…·ä¾› LLM ä½¿ç”¨
- **è‡ªåŠ¨åŒ– Webhook å¤„ç†**: è‡ªåŠ¨æ¥æ”¶å’Œå¤„ç† GitHub PR äº‹ä»¶
- **AI é©±åŠ¨åˆ†æ**: ä½¿ç”¨ OpenAI API æ™ºèƒ½åˆ†æä»£ç å˜æ›´
- **é£ä¹¦çŸ¥è¯†åº“é›†æˆ**: è‡ªåŠ¨å°†åˆ†æç»“æœå‘é€åˆ°é£ä¹¦
- **åŒç•Œé¢æ”¯æŒ**: æä¾› Gradio Web UI å’Œ Flask API ä¸¤ç§æ¥å£
- **å®‰å…¨éªŒè¯**: æ”¯æŒ GitHub Webhook ç­¾åéªŒè¯
- **ä¸°å¯Œä¿¡æ¯**: æå–å®Œæ•´çš„ PR ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€ä½œè€…ã€é“¾æ¥ç­‰ï¼‰

### æŠ€æœ¯æ¶æ„

```
GitHub Webhook â†’ MCP Server â†’ AI Analysis â†’ é£ä¹¦çŸ¥è¯†åº“
     â†“              â†“            â†“            â†“
  PR äº‹ä»¶      è‡ªåŠ¨å¤„ç†     æ™ºèƒ½æ‘˜è¦     ç»“æ„åŒ–å­˜å‚¨
```

## éƒ¨ç½²æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- OpenAI API å¯†é’¥
- GitHub ä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆå¯é€‰ï¼‰
- é£ä¹¦ Webhook URLï¼ˆå¯é€‰ï¼‰

### å®‰è£…æ–¹æ³•

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ uvxï¼ˆæ¨èï¼‰

```bash
# å®‰è£… uvxï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
pip install uvx

# ç›´æ¥è¿è¡Œ
uvx github-pr-mcp-server@latest
```

#### æ–¹æ³•äºŒï¼šä» PyPI å®‰è£…

```bash
pip install github-pr-mcp-server
```

#### æ–¹æ³•ä¸‰ï¼šä»æºç å®‰è£…

```bash
git clone https://github.com/your-username/github-pr-mcp-server.git
cd github-pr-mcp-server
pip install -e .
```

### ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶æˆ–è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# å¿…éœ€é…ç½®
OPENAI_API_KEY=your_openai_api_key_here

# å¯é€‰é…ç½®
WEBHOOK_SECRET=your_github_webhook_secret
FEISHU_WEBHOOK_URL=your_feishu_webhook_url
GITHUB_TOKEN=your_github_token
MCP_SERVER_TYPE=gradio  # æˆ– flask
WEBHOOK_PORT=5000
GRADIO_PORT=8080
```

### å¯åŠ¨æœåŠ¡å™¨

```bash
# å¯åŠ¨ Gradio MCP æœåŠ¡å™¨ï¼ˆé»˜è®¤ï¼‰
github-pr-mcp-server

# æˆ–æŒ‡å®šæœåŠ¡å™¨ç±»å‹
MCP_SERVER_TYPE=flask github-pr-mcp-server
```

### MCP å®¢æˆ·ç«¯é…ç½®

#### æ”¯æŒ SSE çš„å®¢æˆ·ç«¯ï¼ˆå¦‚ Claude Desktopï¼‰

```json
{
  "mcpServers": {
    "github-pr-mcp-server": {
      "command": "uvx",
      "args": ["github-pr-mcp-server@latest"],
      "env": {
        "OPENAI_API_KEY": "YOUR_OPENAI_API_KEY",
        "WEBHOOK_SECRET": "YOUR_WEBHOOK_SECRET",
        "FEISHU_WEBHOOK_URL": "YOUR_FEISHU_WEBHOOK_URL",
        "GITHUB_TOKEN": "YOUR_GITHUB_TOKEN"
      }
    }
  }
}
```

#### ä¸æ”¯æŒ SSE çš„å®¢æˆ·ç«¯

```json
{
  "mcpServers": {
    "github-pr-mcp-server": {
      "command": "npx",
      "args": [
        "mcp-remote",
        "http://your-server:port/gradio_api/mcp/sse"
      ]
    }
  }
}
```

## ä½¿ç”¨ç¤ºä¾‹

### è‡ªåŠ¨åŒ– PR å¤„ç†æµç¨‹

1. **é…ç½® GitHub Webhook**
   - åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ  Webhook
   - URL: `http://your-server:5000/webhook/github`
   - äº‹ä»¶ç±»å‹: é€‰æ‹© "Pull requests"
   - å¯†é’¥: è®¾ç½® `WEBHOOK_SECRET`

2. **åˆ›å»º Pull Request**
   - åœ¨ GitHub ä¸Šåˆ›å»ºæ–°çš„ PR
   - ç³»ç»Ÿè‡ªåŠ¨æ¥æ”¶ Webhook äº‹ä»¶

3. **AI åˆ†æå¤„ç†**
   - ç³»ç»Ÿè‡ªåŠ¨è·å– PR å·®å¼‚å†…å®¹
   - ä½¿ç”¨ OpenAI API åˆ†æä»£ç å˜æ›´
   - ç”Ÿæˆç»“æ„åŒ–æ‘˜è¦

4. **é£ä¹¦é€šçŸ¥**
   - è‡ªåŠ¨å°†æ‘˜è¦å‘é€åˆ°é£ä¹¦çŸ¥è¯†åº“
   - åŒ…å« PR é“¾æ¥ã€ä½œè€…ã€å˜æ›´è¯¦æƒ…ç­‰ä¿¡æ¯

### MCP å‡½æ•°ä½¿ç”¨

#### 1. åˆ†æ PR å·®å¼‚

```python
# åœ¨ MCP å®¢æˆ·ç«¯ä¸­è°ƒç”¨
result = mcp_analyze_pr(
    diff_content="diff --git a/file.py b/file.py...",
    openai_api_key="your_key"
)
print(result)  # è¾“å‡º AI ç”Ÿæˆçš„æ‘˜è¦
```

#### 2. å¤„ç† Webhook è½½è·

```python
# å¤„ç† GitHub Webhook äº‹ä»¶
result = mcp_process_webhook(
    webhook_payload='{"action": "opened", "pull_request": {...}}',
    openai_api_key="your_key",
    feishu_webhook_url="your_webhook_url"
)
print(result)  # è¾“å‡ºå¤„ç†ç»“æœ
```

#### 3. æ‰‹åŠ¨åˆ†æ

```python
# æ‰‹åŠ¨åˆ†æä»£ç å˜æ›´
summary = mcp_manual_analysis(
    diff_content="your_diff_content",
    openai_api_key="your_key",
    feishu_webhook_url="your_webhook_url"
)
print(summary)
```

### è¾“å‡ºç¤ºä¾‹

#### AI åˆ†æç»“æœ

```
## å˜æ›´æ‘˜è¦
æœ¬æ¬¡ PR ä¸»è¦æ·»åŠ äº†ç”¨æˆ·è®¤è¯åŠŸèƒ½å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚

## è¯¦ç»†åˆ†æ
1. æ–°å¢äº†ç”¨æˆ·ç™»å½•æ¨¡å— (auth.py)
   - å®ç°äº† JWT ä»¤ç‰Œç”Ÿæˆå’ŒéªŒè¯
   - æ·»åŠ äº†å¯†ç åŠ å¯†åŠŸèƒ½
   
2. æ”¹è¿›äº†é”™è¯¯å¤„ç† (error_handler.py)
   - ç»Ÿä¸€äº†é”™è¯¯å“åº”æ ¼å¼
   - æ·»åŠ äº†è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

3. æ›´æ–°äº† API æ–‡æ¡£
   - æ·»åŠ äº†æ–°çš„ç«¯ç‚¹è¯´æ˜
   - æ›´æ–°äº†è®¤è¯æµç¨‹æ–‡æ¡£

## å»ºè®®
- å»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•è¦†ç›–æ–°åŠŸèƒ½
- è€ƒè™‘æ·»åŠ é€Ÿç‡é™åˆ¶é˜²æ­¢æš´åŠ›æ”»å‡»
- å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPS
```

#### é£ä¹¦æ¶ˆæ¯æ ¼å¼

```json
{
  "msg_type": "post",
  "content": {
    "post": {
      "zh_cn": {
        "title": "PR #123: æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½",
        "content": [
          [{"tag": "text", "text": "ğŸ“‹ **PR æ‘˜è¦**\n\n"}],
          [{"tag": "text", "text": "ğŸ”— **é“¾æ¥**: https://github.com/repo/pull/123\n"}],
          [{"tag": "text", "text": "ğŸ‘¤ **ä½œè€…**: username\n"}],
          [{"tag": "text", "text": "ğŸ“ **å˜æ›´æ‘˜è¦**: æ·»åŠ äº†ç”¨æˆ·è®¤è¯åŠŸèƒ½...\n"}],
          [{"tag": "text", "text": "ğŸ“… **å¤„ç†æ—¶é—´**: 2024-01-15 14:30:00\n"}]
        ]
      }
    }
  }
}
```

## API ç«¯ç‚¹

### Gradio MCP æœåŠ¡å™¨

- **Web ç•Œé¢**: `http://localhost:8080`
- **MCP ç«¯ç‚¹**: `http://localhost:8080/gradio_api/mcp/sse`
- **Webhook**: `http://localhost:8080/webhook/github`

### Flask MCP æœåŠ¡å™¨

- **Webhook**: `http://localhost:5000/webhook/github`
- **MCP åˆ†æ**: `POST /mcp/analyze`
- **MCP Webhook**: `POST /mcp/process_webhook`
- **å¥åº·æ£€æŸ¥**: `GET /health`

## é…ç½®éªŒè¯

ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨éªŒè¯é…ç½®ï¼š

```bash
ğŸ” éªŒè¯ç¯å¢ƒé…ç½®...
âœ… æ‰€æœ‰ç¯å¢ƒå˜é‡å·²é…ç½®
```

## é”™è¯¯å¤„ç†

- **API å¯†é’¥é”™è¯¯**: æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯
- **ç½‘ç»œè¿æ¥å¤±è´¥**: è‡ªåŠ¨é‡è¯•æœºåˆ¶
- **Webhook éªŒè¯å¤±è´¥**: è¿”å› 401 çŠ¶æ€ç 
- **AI åˆ†æå¤±è´¥**: æä¾›è¯¦ç»†çš„é”™è¯¯åŸå› 

## ç›‘æ§

- **å¥åº·æ£€æŸ¥ç«¯ç‚¹**: `/health`
- **å®æ—¶æ—¥å¿—**: æ§åˆ¶å°è¾“å‡ºè¯¦ç»†å¤„ç†ä¿¡æ¯
- **é”™è¯¯è¿½è¸ª**: å®Œæ•´çš„å¼‚å¸¸å †æ ˆä¿¡æ¯

## å®‰å…¨è€ƒè™‘

- **Webhook ç­¾åéªŒè¯**: é˜²æ­¢ä¼ªé€ è¯·æ±‚
- **API å¯†é’¥ä¿æŠ¤**: æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
- **HTTPS æ”¯æŒ**: ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ HTTPS
- **è®¿é—®æ§åˆ¶**: å¯é…ç½® IP ç™½åå•

## MCP åè®®åˆè§„æ€§

- **æ ‡å‡†å·¥å…·æ ¼å¼**: ç¬¦åˆ MCP å·¥å…·è§„èŒƒ
- **ç±»å‹æ³¨è§£**: å®Œæ•´çš„å‚æ•°ç±»å‹å®šä¹‰
- **æ–‡æ¡£å­—ç¬¦ä¸²**: è¯¦ç»†çš„å‡½æ•°è¯´æ˜
- **é”™è¯¯å¤„ç†**: æ ‡å‡†çš„é”™è¯¯å“åº”æ ¼å¼

## å¼€å‘ä¿¡æ¯

- **é¡¹ç›®åœ°å€**: https://github.com/your-username/github-pr-mcp-server
- **é—®é¢˜åé¦ˆ**: https://github.com/your-username/github-pr-mcp-server/issues
- **æ–‡æ¡£**: https://github.com/your-username/github-pr-mcp-server#readme
- **è®¸å¯è¯**: MIT License

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚ 
