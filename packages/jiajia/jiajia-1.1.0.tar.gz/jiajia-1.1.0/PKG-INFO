Metadata-Version: 2.1
Name: jiajia
Version: 1.1.0
Summary: è½»é‡çº§RSA-AESæ··åˆåŠ å¯†æ¡†æ¶
Home-page: https://github.com/xiatian/jiajia
Author: å¤äº‘é¾™
Author-email: å¤äº‘é¾™ <1900098962@qq.com>
Maintainer-email: å¤äº‘é¾™ <1900098962@qq.com>
License: MIT
Project-URL: Homepage, https://github.com/xiatian/jiajia
Project-URL: Repository, https://github.com/xiatian/jiajia
Project-URL: Documentation, https://github.com/xiatian/jiajia#readme
Project-URL: Issues, https://github.com/xiatian/jiajia/issues
Keywords: encryption,cryptography,rsa,aes,hmac,security,hybrid
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Security :: Cryptography
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: cryptography>=3.4.0
Provides-Extra: redis
Requires-Dist: redis>=4.0.0; extra == "redis"
Provides-Extra: dev
Requires-Dist: pytest>=6.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.18.0; extra == "dev"
Requires-Dist: black>=21.0.0; extra == "dev"
Requires-Dist: flake8>=3.8.0; extra == "dev"

# JiaJia - RSA-AES æ··åˆåŠ å¯†æ¡†æ¶

ä¸€ä¸ªè½»é‡çº§çš„åŠ å¯†è§£å¯†æ¡†æ¶ï¼Œæä¾›RSAéå¯¹ç§°åŠ å¯†ã€AESå¯¹ç§°åŠ å¯†ã€HMACç­¾åéªŒè¯ç­‰åŠŸèƒ½ã€‚å¯ä»¥ç›´æ¥åœ¨å…¶ä»–é¡¹ç›®ä¸­importä½¿ç”¨ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **RSAéå¯¹ç§°åŠ å¯†**: æ”¯æŒ2048ä½å’Œ4096ä½å¯†é’¥
- ğŸ”‘ **AESå¯¹ç§°åŠ å¯†**: æ”¯æŒGCMå’ŒCBCæ¨¡å¼
- âœï¸ **HMACç­¾åéªŒè¯**: ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’ŒçœŸå®æ€§
- ğŸ—‚ï¸ **ä¼šè¯ç®¡ç†**: æ”¯æŒä¼šè¯åˆ›å»ºã€å­˜å‚¨å’Œå¤±æ•ˆ
- âš¡ **å¼‚æ­¥æ”¯æŒ**: å…¨å¼‚æ­¥APIè®¾è®¡
- ğŸ›¡ï¸ **å®‰å…¨é…ç½®**: çµæ´»çš„å®‰å…¨å‚æ•°é…ç½®
- ğŸ“¦ **ä¾¿æ·å‡½æ•°**: æä¾›ç®€å•æ˜“ç”¨çš„ä¾¿æ·å‡½æ•°
- ğŸ”„ **ç¼“å­˜æ”¯æŒ**: æ”¯æŒå†…å­˜å’ŒRedisç¼“å­˜åç«¯

## å®‰è£…

```bash
pip install jiajia
```

## å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨

```python
import asyncio
from jiajia import key_exchange, encrypt_data, decrypt_data, set_config, SecurityConfig

async def main():
    # 1. è®¾ç½®é…ç½®
    config = SecurityConfig(
        rsa_key_size=2048,
        aes_mode="GCM",
        session_expire_time=3600
    )
    set_config(config)
    
    # 2. å¯†é’¥äº¤æ¢ï¼ˆå»ºç«‹å®‰å…¨ä¼šè¯ï¼‰
    exchange_result = await key_exchange("client_app", "1.0.0")
    session_id = exchange_result["session_id"]
    
    # 3. åŠ å¯†æ•°æ®
    sensitive_data = {"user_id": "12345", "email": "user@example.com"}
    encrypt_result = await encrypt_data(sensitive_data, session_id)
    
    # 4. è§£å¯†æ•°æ®
    decrypt_payload = encrypt_result.copy()
    decrypt_payload["session_id"] = session_id
    decrypt_result = await decrypt_data(decrypt_payload)
    
    print(f"è§£å¯†ç»“æœ: {decrypt_result['data']}")

asyncio.run(main())
```

### é«˜çº§ä½¿ç”¨

```python
import asyncio
from jiajia import EncryptionAPI, SecurityConfig

async def advanced_example():
    # åˆ›å»ºè‡ªå®šä¹‰é…ç½®
    config = SecurityConfig(
        rsa_key_size=4096,
        aes_mode="GCM",
        session_expire_time=7200,
        max_timestamp_diff=600
    )
    
    # åˆ›å»ºAPIå®ä¾‹
    api = EncryptionAPI(config)
    
    # å¯†é’¥äº¤æ¢
    exchange_result = await api.key_exchange("advanced_client", "2.0.0")
    session_id = exchange_result["session_id"]
    
    # åŠ å¯†æ•°æ®
    data = {"message": "Hello, World!", "timestamp": 1234567890}
    encrypt_result = await api.encrypt_data(data, session_id)
    
    # è§£å¯†æ•°æ®
    decrypt_payload = encrypt_result.copy()
    decrypt_payload["session_id"] = session_id
    decrypt_result = await api.decrypt_data(decrypt_payload)
    
    # å¥åº·æ£€æŸ¥
    health_result = await api.health_check()
    
    # è·å–å®‰å…¨é…ç½®
    config_result = await api.get_security_config()

asyncio.run(advanced_example())
```

## API å‚è€ƒ

### æ ¸å¿ƒç±»

#### `SecurityConfig`

å®‰å…¨é…ç½®ç±»ï¼Œç”¨äºè®¾ç½®åŠ å¯†å‚æ•°ã€‚

```python
config = SecurityConfig(
    rsa_key_size=2048,        # RSAå¯†é’¥å¤§å°
    aes_mode="GCM",           # AESæ¨¡å¼ (GCM/CBC)
    session_expire_time=3600,  # ä¼šè¯è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    max_timestamp_diff=300,    # æ—¶é—´æˆ³å®¹å·®ï¼ˆç§’ï¼‰
    cache_backend="memory"     # ç¼“å­˜åç«¯ (memory/redis)
)
```

#### `EncryptionAPI`

ä¸»è¦çš„åŠ å¯†APIç±»ã€‚

```python
api = EncryptionAPI(config)

# å¯†é’¥äº¤æ¢
result = await api.key_exchange(client_id, client_version)

# åŠ å¯†æ•°æ®
result = await api.encrypt_data(data, session_id)

# è§£å¯†æ•°æ®
result = await api.decrypt_data(payload)

# ä¼šè¯ç®¡ç†
result = await api.get_session_info(session_id)
result = await api.invalidate_session(session_id)

# ç³»ç»ŸçŠ¶æ€
result = await api.health_check()
result = await api.get_security_config()
```

#### `EncryptionCore`

åŠ å¯†æ ¸å¿ƒç±»ï¼Œæä¾›åº•å±‚åŠ å¯†åŠŸèƒ½ã€‚

```python
core = EncryptionCore(config)

# RSAæ“ä½œ
private_key, public_key = core.generate_rsa_keypair()
encrypted = core.rsa_encrypt(public_key, data)
decrypted = core.rsa_decrypt(private_key, encrypted)

# AESæ“ä½œ
aes_key = core.generate_aes_key()
iv, ciphertext, tag = core.aes_encrypt(aes_key, data)
decrypted = core.aes_decrypt(aes_key, iv, ciphertext, tag)

# HMACæ“ä½œ
hmac_key = core.generate_hmac_key()
signature = core.hmac_sign(hmac_key, data)
is_valid = core.hmac_verify(hmac_key, data, signature)
```

#### `SessionManager`

ä¼šè¯ç®¡ç†ç±»ï¼Œå¤„ç†ä¼šè¯çš„åˆ›å»ºã€å­˜å‚¨å’ŒéªŒè¯ã€‚

```python
session_manager = SessionManager(config)

# ä¼šè¯æ“ä½œ
session_info = await session_manager.create_session(client_id, version)
await session_manager.store_keys(session_id, private_key, hmac_key)
await session_manager.store_aes_key(session_id, aes_key)
session_info = await session_manager.get_session_info(session_id)
await session_manager.invalidate_session(session_id)
is_valid = await session_manager.is_session_valid(session_id)
```

### ä¾¿æ·å‡½æ•°

æ¡†æ¶æä¾›äº†ä¾¿æ·å‡½æ•°ï¼Œç®€åŒ–å¸¸è§æ“ä½œï¼š

```python
from jiajia import (
    key_exchange,
    encrypt_data,
    decrypt_data,
    get_session_info,
    invalidate_session,
    health_check,
    set_config,
    get_api
)

# è®¾ç½®å…¨å±€é…ç½®
set_config(config)

# è·å–å…¨å±€APIå®ä¾‹
api = get_api()

# ä½¿ç”¨ä¾¿æ·å‡½æ•°
result = await key_exchange("client", "1.0.0")
result = await encrypt_data(data, session_id)
result = await decrypt_data(payload)
result = await get_session_info(session_id)
result = await invalidate_session(session_id)
result = await health_check()
```

## é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡

å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®æ¡†æ¶ï¼š

```bash
export RSA_KEY_SIZE=4096
export AES_MODE=GCM
export SESSION_EXPIRE_TIME=7200
export MAX_TIMESTAMP_DIFF=600
export CACHE_BACKEND=memory
export LOG_LEVEL=INFO
export ENABLE_LOGGING=true
```

### é…ç½®å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `rsa_key_size` | 2048 | RSAå¯†é’¥å¤§å°ï¼ˆä½ï¼‰ |
| `aes_mode` | "GCM" | AESåŠ å¯†æ¨¡å¼ |
| `aes_key_size` | 32 | AESå¯†é’¥å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `session_expire_time` | 3600 | ä¼šè¯è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ |
| `max_timestamp_diff` | 300 | æ—¶é—´æˆ³å®¹å·®ï¼ˆç§’ï¼‰ |
| `cache_backend` | "memory" | ç¼“å­˜åç«¯ç±»å‹ |
| `redis_url` | None | Redisè¿æ¥URL |
| `log_level` | "INFO" | æ—¥å¿—çº§åˆ« |
| `enable_logging` | True | æ˜¯å¦å¯ç”¨æ—¥å¿— |

## å®‰å…¨ç‰¹æ€§

- **æ··åˆåŠ å¯†**: ç»“åˆRSAå’ŒAESçš„ä¼˜åŠ¿
- **HMACç­¾å**: ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’ŒçœŸå®æ€§
- **æ—¶é—´æˆ³éªŒè¯**: é˜²æ­¢é‡æ”¾æ”»å‡»
- **ä¼šè¯ç®¡ç†**: å®‰å…¨çš„ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **å¯†é’¥è½®æ¢**: æ”¯æŒåŠ¨æ€å¯†é’¥ç”Ÿæˆå’Œå­˜å‚¨

## æ€§èƒ½ç‰¹æ€§

- **å¼‚æ­¥è®¾è®¡**: å…¨å¼‚æ­¥APIï¼Œæ”¯æŒé«˜å¹¶å‘
- **ç¼“å­˜æ”¯æŒ**: å†…å­˜å’ŒRedisç¼“å­˜åç«¯
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ•°æ®å¤„ç†
- **è½»é‡çº§**: æœ€å°åŒ–ä¾èµ–ï¼Œå¿«é€Ÿå¯åŠ¨

## é”™è¯¯å¤„ç†

æ¡†æ¶æä¾›äº†å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

```python
try:
    result = await encrypt_data(data, session_id)
    if result["success"]:
        # å¤„ç†æˆåŠŸç»“æœ
        pass
    else:
        # å¤„ç†é”™è¯¯
        print(f"é”™è¯¯: {result['error']}")
except Exception as e:
    # å¤„ç†å¼‚å¸¸
    print(f"å¼‚å¸¸: {e}")
```

## æµ‹è¯•

è¿è¡Œæµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸ï¼š

```bash
python -c "
import asyncio
from jiajia import key_exchange, encrypt_data, decrypt_data, SecurityConfig, set_config

async def test():
    config = SecurityConfig()
    set_config(config)
    
    # æµ‹è¯•åŸºæœ¬åŠŸèƒ½
    exchange = await key_exchange('test', '1.0.0')
    session_id = exchange['session_id']
    
    data = {'test': 'data'}
    encrypted = await encrypt_data(data, session_id)
    
    payload = encrypted.copy()
    payload['session_id'] = session_id
    decrypted = await decrypt_data(payload)
    
    print('æµ‹è¯•é€šè¿‡!' if decrypted['data'] == data else 'æµ‹è¯•å¤±è´¥!')

asyncio.run(test())
"
```

## è®¸å¯è¯

MIT License

## ä½œè€…

å¤äº‘é¾™

## ç‰ˆæœ¬

1.1.0
