(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{58095:function(e,t,n){var s=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&s(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var s=-1,r=null==e?0:e.length;++s<r;)if(n(t,e[s]))return!0;return!1}},8817:function(e,t,n){var s=n(95372),r=n(1129),a=n(58263);e.exports=function(e,t,n){return t==t?a(e,t,n):s(e,r,n)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,n){var s=n(52485),r=n(58095),a=n(21796),o=n(65581),i=n(47111),l=n(43735);e.exports=function(e,t,n){var d=-1,c=r,u=e.length,h=!0,m=[],g=m;if(n)h=!1,c=a;else if(u>=200){var v=t?null:i(e);if(v)return l(v);h=!1,c=o,g=new s}else g=t?[]:m;e:for(;++d<u;){var p=e[d],y=t?t(p):p;if(p=n||0!==p?p:0,h&&y==y){for(var f=g.length;f--;)if(g[f]===y)continue e;t&&g.push(y),m.push(p)}else c(g,y,n)||(g!==m&&g.push(y),m.push(p))}return m}},47111:function(e,t,n){var s=n(46151),r=n(50344),a=n(43735),o=s&&1/a(new s([,-0]))[1]==1/0?function(e){return new s(e)}:r;e.exports=o},58263:function(e){e.exports=function(e,t,n){for(var s=n-1,r=e.length;++s<r;)if(e[s]===t)return s;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,n){var s=n(92198);e.exports=function(e){return e&&e.length?s(e):[]}},25654:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]/[systemId]",function(){return n(56514)}])},79283:function(e,t,n){"use strict";n.d(t,{l:function(){return l}});var s=n(24246),r=n(13577),a=n(72707),o=n.n(a);let i=e=>{let{data:{formattedTitle:t,description:n,name:a,primaryName:o}}=e;return(0,s.jsxs)(r.jqI,{gap:12,title:"".concat(t," - ").concat(n),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:o||a}),o&&": ".concat(a)]}),(0,s.jsx)("em",{children:n})]})},l=e=>{let{options:t,...n}=e,a=null==t?void 0:t.map(e=>({...e,className:o().option,formattedTitle:[e.primaryName,e.name].filter(e=>e).join(": ")}));return(0,s.jsx)(r.WPr,{options:a,filterOption:(e,t)=>(null==t?void 0:t.formattedTitle.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:t.value.toLowerCase().includes(e.toLowerCase()))||!1,optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:i,dropdownStyle:{minWidth:"500px"},className:"w-full p-0","data-testid":"taxonomy-select",...n})}},14047:function(e,t,n){"use strict";n.d(t,{H:function(){return a},V:function(){return s.V}});var s=n(84306),r=n(812);let a=()=>{let{errorAlert:e}=(0,s.V)();return{handleError:t=>{let n="An unexpected error occurred. Please try again.";(0,r.Ot)(t)?n=t.data.detail:(0,r.tB)(t)&&(n=t.data.detail[0].msg),e(n)}}}},84306:function(e,t,n){"use strict";n.d(t,{V:function(){return a}});var s=n(24246),r=n(13577);let a=()=>{let e=(0,r.pmc)();return{errorAlert:(t,n,a)=>{let o={...a,position:(null==a?void 0:a.position)||"top",render:e=>{let{onClose:a}=e;return(0,s.jsxs)(r.bZj,{alignItems:"normal",status:"error","data-testid":"error-alert",children:[(0,s.jsx)(r.zMQ,{}),(0,s.jsxs)(r.xuv,{children:[n&&(0,s.jsx)(r.CdC,{children:n}),(0,s.jsx)(r.XaZ,{children:t})]}),(0,s.jsx)(r.PZ7,{onClick:a,position:"relative",right:0,size:"sm",top:-1})]})}};(null==a?void 0:a.id)&&e.isActive(a.id)?e.update(a.id,o):e(o)},successAlert:(t,n,a)=>{let o={...a,position:(null==a?void 0:a.position)||"top",render:e=>{let{onClose:a}=e;return(0,s.jsxs)(r.bZj,{alignItems:"normal",status:"success",variant:"subtle","data-testid":"success-alert",children:[(0,s.jsx)(r.zMQ,{}),(0,s.jsxs)(r.xuv,{children:[n&&(0,s.jsx)(r.CdC,{children:n}),(0,s.jsx)(r.XaZ,{children:t})]}),(0,s.jsx)(r.PZ7,{onClick:a,position:"relative",right:0,size:"sm",top:-1})]})}};(null==a?void 0:a.id)&&e.isActive(a.id)?e.update(a.id,o):e(o)}}}},45938:function(e,t,n){"use strict";n.d(t,{Gt:function(){return h},eB:function(){return m},oI:function(){return u}});var s=n(24246),r=n(34090),a=n(27378),o=n(16134),i=n(38602),l=n(58452);let d=(0,a.createRef)(),c=(0,a.createRef)(),u=()=>{let e=(0,o.T)(),t=(0,o.C)(i.DB),n=(0,a.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),s=(0,a.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!0),n())},[e,n]),r=(0,a.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!1),n())},[e,n]);return{attemptAction:(0,a.useCallback)(()=>t?(e((0,i.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:s,onClose:r}},h=e=>{let{id:t,name:n}=e,{dirty:s}=(0,r.u6)(),l=(0,o.T)();return(0,a.useEffect)(()=>(l((0,i.Zu)({id:t,name:n})),()=>{l((0,i.dz)({id:t}))}),[l,t,n]),(0,a.useEffect)(()=>{l((0,i.$p)({id:t,isDirty:s}))},[s,l,t]),null},m=()=>{let{onConfirm:e,onClose:t}=u(),n=(0,o.C)(i.uv);return(0,s.jsx)(l.Z,{isOpen:n,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},56514:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Q}});var s=n(24246),r=n(86677),a=n(27378),o=n(35287),i=n(77830),l=n(58754),d=n(13577),c=n(83766),u=n.n(c),h=n(812),m=n(25415),g=n(46628),v=n(54682),p=n(30952),y=n(37059),f=n(8133),x=n(79283),j=n(34929),_=n(78238),C=e=>{let{selectedTaxonomies:t,...n}=e,{getDataUseDisplayNameProps:r,getDataUses:a}=(0,j.Z)(),o=a().filter(e=>e.active&&_.g.includes(e.fides_key)).map(e=>{let{name:t,primaryName:n}=r(e.fides_key);return{value:e.fides_key,name:t,primaryName:n,description:e.description||""}});return(0,s.jsx)(x.l,{options:o,...n})};let{Text:w}=d.AntTypography;var S=e=>{let{onSave:t,isSaving:n,onClose:r,...o}=e,[i,l]=(0,a.useState)([]),c=()=>{l([]),r()};return(0,s.jsxs)(f.Z,{title:"Add consent category",...o,onClose:c,children:[(0,s.jsxs)(d.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,s.jsx)(w,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,s.jsx)(C,{mode:"tags",selectedTaxonomies:i,onSelect:(e,t)=>l([...i,t.value]),variant:"outlined"})]}),(0,s.jsxs)(d.jqI,{justify:"space-between",children:[(0,s.jsx)(d.wpx,{htmlType:"reset",onClick:c,"data-testid":"cancel-btn",children:"Cancel"}),(0,s.jsx)(d.wpx,{htmlType:"submit",type:"primary",disabled:!i.length,loading:n,onClick:()=>{t(i),c()},"data-testid":"save-btn",children:"Save"})]})]})},b=n(29850),E=n(77685);let{Text:k}=d.AntTypography,T=e=>{let{onSave:t,isSaving:n,...r}=e,[o,i]=(0,a.useState)(),[l,c]=(0,a.useState)(!1),u=(0,a.useCallback)(e=>{e.preventDefault(),c(!0)},[]),h=()=>{c(!1)},m=()=>{i(void 0),r.onClose()};return(0,s.jsxs)(f.Z,{title:"Assign system",...r,onClose:m,children:[(0,s.jsxs)(d.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,s.jsx)(k,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,s.jsx)(b.R,{placeholder:"Search or select...",onSelect:(e,t)=>{i(t)},onAddSystem:u,value:o})]})," ",(0,s.jsxs)(d.jqI,{justify:"space-between",children:[(0,s.jsx)(d.wpx,{htmlType:"reset",onClick:m,"data-testid":"cancel-btn",children:"Cancel"}),(0,s.jsx)(d.wpx,{htmlType:"submit",type:"primary",disabled:!o,loading:n,onClick:()=>{t(o),m()},"data-testid":"save-btn",children:"Save"})]}),l&&(0,s.jsx)(E.i,{isOpen:!0,onClose:h,onSuccessfulSubmit:(e,t)=>{h(),i({label:t,value:e})},toastOnSuccess:!0})]})};var A=n(8411),N=n(47935);let{Paragraph:I,Text:O,Link:D}=d.AntTypography,L=e=>{var t,n,r;let{isOpen:o,stagedResource:i,status:l,onCancel:c,onDownload:u}=e,[h,m]=(0,a.useState)(1),[g,v]=(0,a.useState)(N.W3[0]),{data:p,isFetching:f,isError:x}=(0,y.mi)({stagedResourceUrn:i.urn,status:l,page:h,size:g}),{items:j,total:_}=(0,a.useMemo)(()=>p||{items:[],total:0,pages:0,filterOptions:{assigned_users:[],systems:[]}},[p]);return(0,s.jsx)(d.$zI,{title:"Consent discovery",width:768,open:o,onCancel:c,footer:[(0,s.jsx)(d.wpx,{onClick:c,children:"Cancel"},"cancel"),!!u&&(0,s.jsx)(d.wpx,{type:"primary",onClick:u,children:"Download"},"download")],"data-testid":"consent-breakdown-modal",children:(0,s.jsxs)(d.jqI,{vertical:!0,className:"gap-6","data-testid":"consent-breakdown-modal-content",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(I,{children:"View all instances where this asset was detected without consent, organized by location and page. Use this to investigate potential compliance issues."}),(0,s.jsxs)(I,{children:[(0,s.jsx)(O,{strong:!0,children:"Asset name:"})," ",null!==(t=i.name)&&void 0!==t?t:(0,s.jsx)(O,{italic:!0,children:"Unknown"}),","," ",(0,s.jsx)(O,{strong:!0,children:"System:"})," ",null!==(n=i.system)&&void 0!==n?n:(0,s.jsx)(O,{italic:!0,children:"Unassigned"}),","," ",(0,s.jsx)(O,{strong:!0,children:"Domain:"})," ",null!==(r=i.domain)&&void 0!==r?r:(0,s.jsx)(O,{italic:!0,children:"Unknown"})]})]}),x?(0,s.jsx)(d.DUx,{type:"error",message:"Error fetching data",description:"Please try again later.",showIcon:!0}):(0,s.jsx)(d.V5H,{columns:[{title:"Location",dataIndex:"location",key:"location",render:e=>{var t;return null!==(t=A.Z8[e])&&void 0!==t?t:e}},{title:"Page",dataIndex:"page",key:"page",render:e=>(0,s.jsx)(D,{href:e,target:"_blank",rel:"noopener noreferrer",children:e})}],rowKey:e=>e.location,dataSource:j,pagination:!!_&&(h>1||g>N.W3[0])&&{current:h,pageSize:g,total:_||0,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items"),onChange:(e,t)=>{m(e),t!==g&&(v(t),m(1))}},loading:f,"data-testid":"consent-breakdown-modal-table"})]})})};var P=n(98145),R=n(88708),U=n(62165),Z=n(91982),M=n(16394),V=n(54762),G=n(9320);let z=e=>{let{asset:t,onTabChange:n}=e,[a,{isLoading:o}]=(0,y.EY)(),[l,{isLoading:c}]=(0,y.nS)(),[u,{isLoading:m}]=(0,y.Tj)(),p=(0,d.pmc)(),f=(0,r.useRouter)(),x=o||c||m,{urn:j,name:_,resource_type:C,diff_status:w,system_key:S,user_assigned_system_key:b}=t,E=async()=>{let e=await a({urnList:[j]});if((0,h.D4)(e))p((0,g.Vo)((0,h.e$)(e.error)));else{let e=b||S,t="".concat(i.So,"/configure/").concat(e,"#assets");p((0,g.t5)((0,G._)("".concat(C,' "').concat(_,'" has been added to the system inventory.'),e?()=>f.push(t):void 0)))}},k=async()=>{let e=await l({urnList:[j]});(0,h.D4)(e)?p((0,g.Vo)((0,h.e$)(e.error))):p((0,g.t5)((0,G._)("".concat(C,' "').concat(_,'" has been ignored and will not appear in future scans.'),()=>n(R.A.IGNORED))))},T=async()=>{let e=await u({urnList:[j]});(0,h.D4)(e)?p((0,g.Vo)((0,h.e$)(e.error))):p((0,g.t5)("".concat(C,' "').concat(_,'" is no longer ignored and will appear in future scans.')))};return(0,s.jsxs)(d.vyj,{children:[w!==v.LL.MUTED&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.esZ,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,s.jsx)(d.wpx,{"data-testid":"add-btn",size:"small",onClick:E,disabled:!t.system||x,loading:o,children:"Add"})}),(0,s.jsx)(d.wpx,{"data-testid":"ignore-btn",size:"small",onClick:k,disabled:x,loading:c,children:"Ignore"})]}),w===v.LL.MUTED&&(0,s.jsx)(d.wpx,{"data-testid":"restore-btn",size:"small",onClick:T,disabled:x,loading:m,children:"Restore"})]})};var W=n(14047),X=n(18992),$=n.n(X),B=n(31883),K=e=>{var t,n,r;let{asset:o,readonly:i}=e,[l,c]=(0,a.useState)(!1),[u]=(0,y.Ak)(),{successAlert:m,errorAlert:g}=(0,W.V)(),{getDataUseDisplayName:v}=(0,j.Z)(),p=(null===(t=o.user_assigned_data_uses)||void 0===t?void 0:t.length)?o.user_assigned_data_uses:(null===(n=o.data_uses)||void 0===n?void 0:n.length)?o.data_uses:[],f=async e=>{let t=await u({monitorId:o.monitor_config_id,urnList:[o.urn],dataUses:[...p,e]});(0,B.D4)(t)?g((0,h.e$)(t.error)):m("Consent category added to ".concat(o.resource_type,' "').concat(o.name,'" .'),"Confirmed"),c(!1)},x=async e=>{let t=await u({monitorId:o.monitor_config_id,urnList:[o.urn],dataUses:p.filter(t=>t!==e)});(0,B.D4)(t)?g((0,h.e$)(t.error)):m("Consent category removed from ".concat(o.resource_type,' "').concat(o.name,'".'),"Confirmed")},w=(null===(r=o.user_assigned_data_uses)||void 0===r?void 0:r.length)?o.user_assigned_data_uses:o.data_uses,S=null==w?void 0:w.filter(e=>(0,_.Z)(e));return i?(0,s.jsx)(d.vyj,{direction:"vertical",children:null==S?void 0:S.map(e=>(0,s.jsx)(d.j8w,{color:"white",children:v(e)},e))}):(0,s.jsxs)(s.Fragment,{children:[!l&&(0,s.jsxs)(d.vyj,{wrap:!0,children:[null==S?void 0:S.map(e=>(0,s.jsx)(d.j8w,{"data-testid":"data-use-".concat(e),color:"white",closable:!0,onClose:()=>x(e),closeButtonLabel:"Remove data use",children:v(e)},e)),(0,s.jsx)(d.j8w,{onClick:()=>c(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"})]}),l&&(0,s.jsx)("div",{className:$().cellBleed,style:{backgroundColor:"var(--fides-color-white)"},children:(0,s.jsx)(C,{selectedTaxonomies:S||[],onSelect:f,onBlur:()=>c(!1),open:!0})})]})};let Y=e=>{let{consentAggregated:t,stagedResource:n,onShowBreakdown:r}=e;return(0,s.jsxs)(s.Fragment,{children:[t===v.lg.WITHOUT_CONSENT&&(0,s.jsx)(d.esZ,{title:"Asset was detected before the user gave consent or without any consent. Click the info icon for more details.",children:(0,s.jsx)(d.j8w,{color:"error",closeIcon:(0,s.jsx)(d.PJP.daM,{style:{width:12,height:12}}),closeButtonLabel:"View details",onClose:()=>{null==r||r(n,t)},"data-testid":"status-badge_without-consent",children:P.X.WITHOUT_CONSENT})}),t===v.lg.WITH_CONSENT&&(0,s.jsx)(d.esZ,{title:"Asset was detected after the user gave consent",children:(0,s.jsx)(d.j8w,{color:"success","data-testid":"status-badge_with-consent",children:P.X.WITH_CONSENT})}),t===v.lg.EXEMPT&&(0,s.jsx)(d.esZ,{title:"Asset is valid regardless of consent",children:(0,s.jsx)(d.j8w,{"data-testid":"status-badge_consent-exempt",children:P.X.EXEMPT})}),t===v.lg.UNKNOWN&&(0,s.jsx)(d.esZ,{title:"Did not find consent information for this asset. You may need to re-run the monitor.",children:(0,s.jsx)(d.j8w,{"data-testid":"status-badge_unknown",children:P.X.UNKNOWN})})]})};var q=n(70675);let H=e=>{let{aggregateSystem:t,monitorConfigId:n,readonly:r}=e,{resource_type:o,name:i,urn:l,system:c,user_assigned_system_key:u,system_key:m}=t,[g,v]=(0,a.useState)(!1),[p,y]=(0,a.useState)(!1),[f,{isLoading:x}]=(0,q.NA)(),{successAlert:j,errorAlert:_}=(0,W.V)(),C=(0,a.useCallback)(e=>{e.preventDefault(),y(!0)},[]),w=async(e,t,s)=>{let r=await f({staged_resource_urn:l,monitor_config_id:n,user_assigned_system_key:e});(0,h.D4)(r)?_((0,h.e$)(r.error)):j(s?"".concat(t," has been added to your system inventory and the ").concat(o,' "').concat(i,'" has been assigned to that system.'):"".concat(o,' "').concat(i,'" has been assigned to ').concat(t,"."),"Confirmed"),v(!1)};return r?c?(0,s.jsx)(d.j8w,{"data-testid":"system-badge",color:"white",children:c}):null:(0,s.jsxs)(s.Fragment,{children:[!g&&(c?(0,s.jsxs)(d.j8w,{onClick:()=>v(!0),"data-testid":"system-badge",children:[c,(0,s.jsx)(d.PJP.I8b,{})]}):(0,s.jsx)(d.j8w,{onClick:()=>v(!0),"data-testid":"add-system-btn",addable:!0})),!!g&&(0,s.jsx)("div",{className:$().cellBleed,children:(0,s.jsx)(b.R,{variant:"borderless",autoFocus:!0,defaultOpen:!0,defaultValue:u||m,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&v(!1)},onAddSystem:C,onSelect:(e,t)=>w(e,t.label),loading:x})}),p&&(0,s.jsx)(E.i,{isOpen:!0,onClose:()=>{y(!1)},onSuccessfulSubmit:(e,t)=>w(e,t,!0)})]})},F=e=>{let{readonly:t,aggregatedConsent:n,onTabChange:r,onShowBreakdown:o,monitorConfigId:i,resolvedSystemId:l,diffStatus:c,columnFilters:u,sortField:h,sortOrder:m,searchQuery:g}=e,{flags:p}=(0,U.hz)(),{assetConsentStatusLabels:f}=p,[x,j]=(0,a.useState)(!1),[C,w]=(0,a.useState)(!1),{data:S}=(0,y.ut)({monitor_config_id:i,resolved_system_id:l,diff_status:c,search:g,...u});return{columns:(0,a.useMemo)(()=>{var e;let a=[{title:"Asset",dataIndex:P.r.NAME,key:P.r.NAME,sorter:!0,sortOrder:h===P.r.NAME?m:null,render:e=>(0,s.jsx)(d.lKn,{ellipsis:{tooltip:!0},style:{maxWidth:300},children:e}),fixed:"left"},{title:"Type",dataIndex:P.r.RESOURCE_TYPE,key:P.r.RESOURCE_TYPE,sorter:!0,sortOrder:h===P.r.RESOURCE_TYPE?m:null,filters:(0,M.nZ)(null==S?void 0:S.resource_type),filteredValue:(null==u?void 0:u.resource_type)||null},{title:"System",dataIndex:P.r.SYSTEM,key:P.r.SYSTEM,width:200,sorter:!0,sortOrder:h===P.r.SYSTEM?m:null,render:(e,n)=>!!n.monitor_config_id&&(0,s.jsx)(H,{aggregateSystem:n,monitorConfigId:n.monitor_config_id,readonly:t})},{title:"Categories of consent",key:P.r.DATA_USES,width:400,filters:(0,M.nZ)(null==S?void 0:null===(e=S.data_uses)||void 0===e?void 0:e.filter(e=>(0,_.Z)(e))),filteredValue:(null==u?void 0:u.data_uses)||null,sorter:!0,sortOrder:h===P.r.DATA_USES?m:null,render:(e,n)=>(0,s.jsx)(K,{asset:n,readonly:t})},{title:()=>(0,s.jsx)(Z.OL,{title:"Locations",menu:{items:Z.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?j(!0):"collapse-all"===e.key&&j(!1)}}}),dataIndex:P.r.LOCATIONS,key:P.r.LOCATIONS,width:250,sorter:!0,sortOrder:h===P.r.LOCATIONS?m:null,filters:(0,M.nZ)(null==S?void 0:S.locations,e=>{var t;return null!==(t=A.Z8[e])&&void 0!==t?t:e}),filteredValue:(null==u?void 0:u.locations)||null,render:e=>{var t;return(0,s.jsx)(Z.Q3,{values:null!==(t=null==e?void 0:e.map(e=>{var t;return{label:null!==(t=A.Z8[e])&&void 0!==t?t:e,key:e}}))&&void 0!==t?t:[],columnState:{isExpanded:x,isWrapped:!0}})}},{title:"Domain",dataIndex:P.r.DOMAIN,key:P.r.DOMAIN,sorter:!0,sortOrder:h===P.r.DOMAIN?m:null},{title:()=>(0,s.jsx)(Z.OL,{title:"Detected on",menu:{items:Z.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?w(!0):"collapse-all"===e.key&&w(!1)}}}),dataIndex:P.r.PAGE,key:P.r.PAGE,sorter:!0,sortOrder:h===P.r.PAGE?m:null,render:e=>(0,s.jsx)(Z.vx,{values:e,valueSuffix:"pages",columnState:{isExpanded:C}})}];return f&&a.push({title:()=>(0,s.jsxs)(d.vyj,{children:[(0,s.jsx)("div",{children:"Compliance"}),n===v.lg.WITHOUT_CONSENT&&(0,s.jsx)(V.l,{consentStatus:{status:v.pF.ALERT,message:"One or more assets were detected without consent"}})]}),dataIndex:P.r.CONSENT_AGGREGATED,key:P.r.CONSENT_AGGREGATED,sorter:!0,sortOrder:h===P.r.CONSENT_AGGREGATED?m:null,filters:(0,M.nZ)(null==S?void 0:S[P.r.CONSENT_AGGREGATED],e=>{var t;return null!==(t=({with_consent:P.X.WITH_CONSENT,without_consent:P.X.WITHOUT_CONSENT,exempt:P.X.EXEMPT,unknown:P.X.UNKNOWN})[e])&&void 0!==t?t:e}),filteredValue:(null==u?void 0:u[P.r.CONSENT_AGGREGATED])||null,render:(e,t)=>(0,s.jsx)(Y,{consentAggregated:null!=e?e:v.lg.UNKNOWN,stagedResource:t,onShowBreakdown:o})}),t||a.push({title:"Actions",key:P.r.ACTIONS,fixed:"right",render:(e,t)=>(0,s.jsx)(z,{asset:t,onTabChange:r})}),a},[S,u,h,m,f,t,x,C,n,o,r])}},J=e=>{var t;let{monitorId:n,systemId:o,onSystemName:l}=e,c=(0,r.useRouter)(),[f,x]=(0,a.useState)(),[j,_]=(0,a.useState)(o),[C,w]=(0,a.useState)(1),[b,E]=(0,a.useState)(25),[k,A]=(0,a.useState)({}),[N,I]=(0,a.useState)(),[O,D]=(0,a.useState)(),[U,Z]=(0,a.useState)([]),[M,V]=(0,a.useState)(new Map),z=()=>{Z([]),V(new Map)},[W,X]=(0,a.useState)(!1),[$,B]=(0,a.useState)(!1),[K,Y]=(0,a.useState)(null),[q,{isLoading:H}]=(0,y.EY)(),[J,{isLoading:Q}]=(0,y.nS)(),[ee,{isLoading:et}]=(0,y.rs)(),[en,{isLoading:es}]=(0,y.sX)(),[er,{isLoading:ea}]=(0,y.Vr)(),[eo,{isLoading:ei}]=(0,y.Tj)(),el=H||Q||et||es||ei,ed=el||o===i.Kl,[ec,eu]=(0,a.useState)(""),eh=(0,d.pmc)(),{filterTabs:em,activeTab:eg,onTabChange:ev,activeParams:ep,actionsDisabled:ey}=(0,R.Z)(o);(0,a.useEffect)(()=>{w(1)},[n,ec,eg]),(0,a.useEffect)(()=>{z()},[n,eg]);let{data:ef,isLoading:ex,isFetching:ej}=(0,y.WJ)({key:n,page:C,size:b,search:ec,sort_by:N?[N]:[P.r.CONSENT_AGGREGATED,"urn"],sort_asc:"descend"!==O,...ep,...k});(0,a.useEffect)(()=>{if(ef){var e;let t=(null===(e=ef.items[0])||void 0===e?void 0:e.system)||j||o||"";_(t),null==l||l(t)}},[ef,o,l,j]),(0,a.useEffect)(()=>{if((null==ef?void 0:ef.items)&&!f){var e;x(null===(e=ef.items.find(e=>e.consent_aggregated===v.lg.WITHOUT_CONSENT))||void 0===e?void 0:e.consent_aggregated)}},[ef,f]);let{columns:e_}=F({readonly:null!=ey&&ey,onTabChange:ev,aggregatedConsent:f,onShowBreakdown:(e,t)=>{Y({stagedResource:e,status:t})},monitorConfigId:n,resolvedSystemId:o,diffStatus:null==ep?void 0:ep.diff_status,columnFilters:k,sortField:N,sortOrder:O,searchQuery:ec}),eC=Array.from(M.keys()),ew=Array.from(M.values()),eS=async()=>{var e,t;let n=await q({urnList:eC}),s=(null===(e=ew[0])||void 0===e?void 0:e.user_assigned_system_key)||(null===(t=ew[0])||void 0===t?void 0:t.system_key),r=ew.every(e=>(e.user_assigned_system_key||e.system_key)===s)?s:void 0;(0,h.D4)(n)?eh((0,g.Vo)((0,h.e$)(n.error))):(eh((0,g.t5)((0,G._)("".concat(eC.length," assets from ").concat(j," have been added to the system inventory."),r?()=>c.push("".concat(i.So,"/configure/").concat(r,"#assets")):()=>c.push(i.So)))),z())},eb=async e=>{if("string"==typeof(null==e?void 0:e.value)){let t=await en({monitorId:n,urnList:eC,systemKey:e.value});(0,h.D4)(t)?eh((0,g.Vo)((0,h.e$)(t.error))):eh((0,g.t5)("".concat(eC.length," assets have been assigned to ").concat(e.label,"."),"Confirmed"))}X(!1)},eE=async e=>{if(!ew.length)return;let t=ew.map(t=>{let n=u()([...t.user_assigned_data_uses||t.data_uses||[],...e]);return{urn:t.urn,user_assigned_data_uses:n}}),s=await er({monitorId:n,assets:t});(0,h.D4)(s)?eh((0,g.Vo)((0,h.e$)(s.error))):eh((0,g.t5)("Consent categories added to ".concat(eC.length," assets").concat(j?" from ".concat(j):"","."),"Confirmed")),B(!1)},ek=async()=>{let e=await J({urnList:eC});(0,h.D4)(e)?eh((0,g.Vo)((0,h.e$)(e.error))):(eh((0,g.t5)(j===i.Kl?"".concat(eC.length," uncategorized assets have been ignored and will not appear in future scans."):"".concat(eC.length," assets from ").concat(j," have been ignored and will not appear in future scans."),"Confirmed")),z())},eT=async()=>{let e=await eo({urnList:eC});(0,h.D4)(e)?eh((0,g.Vo)((0,h.e$)(e.error))):(eh((0,g.t5)("".concat(eC.length," assets have been restored and will appear in future scans."),"Confirmed")),z())},eA=async()=>{let e=(null==ef?void 0:ef.items.length)||0,t=await ee({monitor_config_key:n,resolved_system_ids:[o]});(0,h.D4)(t)?eh((0,g.Vo)((0,h.e$)(t.error))):(c.push("".concat(i.vi,"/").concat(n)),eh((0,g.t5)("".concat(e," assets from ").concat(j," have been added to the system inventory."),"Confirmed")),z())},eN=e=>{ev(e),z()};return((0,a.useEffect)(()=>{(null==ef?void 0:ef.items)&&Z(ef.items.filter(e=>M.has(e.urn)).map(e=>e.urn))},[ef,M]),n&&o)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A5g,{items:em.map(e=>({key:e.hash,label:e.label})),activeKey:eg,onChange:e=>eN(e)}),(0,s.jsxs)(d.jqI,{justify:"space-between",align:"center",className:"mb-4",children:[(0,s.jsx)(p.f,{value:ec,onChange:eu,placeholder:"Search by asset name..."}),(0,s.jsxs)(d.vyj,{size:"large",children:[!!eC.length&&(0,s.jsx)(m.a,{count:eC.length}),(0,s.jsxs)(d.vyj,{size:"small",children:[(0,s.jsx)(d.wpx,{onClick:()=>{A({}),eu(""),I(void 0),D(void 0)},"data-testid":"clear-filters",children:"Clear filters"}),(0,s.jsx)(d.S0p,{menu:{items:[{key:"add",label:"Add",onClick:eS},{key:"add-data-use",label:"Add consent category",onClick:()=>B(!0)},{key:"assign-system",label:"Assign system",onClick:()=>X(!0)},...(null==ep?void 0:null===(t=ep.diff_status)||void 0===t?void 0:t.includes(v.LL.MUTED))?[{key:"restore",label:"Restore",onClick:eT}]:[{type:"divider"},{key:"ignore",label:"Ignore",onClick:ek}]]},trigger:["click"],children:(0,s.jsx)(d.wpx,{icon:(0,s.jsx)(d.PJP._ME,{}),iconPosition:"end",loading:el,"data-testid":"bulk-actions-menu",disabled:!eC.length||el||ey,type:"primary",children:"Actions"})}),(0,s.jsx)(d.esZ,{title:ed?"These assets require a system before you can add them to the inventory.":void 0,children:(0,s.jsx)(d.wpx,{onClick:eA,disabled:ed,loading:et,type:"primary",icon:(0,s.jsx)(d.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,s.jsx)(d.V5H,{dataSource:(null==ef?void 0:ef.items)||[],columns:e_,loading:ex||ej,rowKey:e=>e.urn,rowSelection:eg===R.A.RECENT_ACTIVITY?void 0:{selectedRowKeys:U,onChange:(e,t)=>{Z(e);let n=new Map(M);(null==ef?void 0:ef.items)&&ef.items.forEach(t=>{e.includes(t.urn)||n.delete(t.urn)}),t.forEach(e=>{n.set(e.urn,e)}),V(n)}},pagination:{current:C,pageSize:b,total:(null==ef?void 0:ef.total)||0},onChange:(e,t,n)=>{e.current!==C||e.pageSize!==b?w(e.current||1):w(1),E(e.pageSize||25),A(t||{});let s=n&&!Array.isArray(n)?n.field:void 0,r=n&&!Array.isArray(n)&&null!==n.order?n.order:void 0;I(s),D(r)},locale:{emptyText:(0,s.jsx)(d.oj8,{image:d.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}}),(0,s.jsx)(T,{isOpen:W,onClose:()=>{X(!1)},onSave:eb,isSaving:es}),(0,s.jsx)(S,{isOpen:$,onClose:()=>{B(!1)},onSave:eE,isSaving:ea}),K&&(0,s.jsx)(L,{isOpen:!!K,stagedResource:K.stagedResource,status:K.status,onCancel:()=>{Y(null)}})]}):null};var Q=()=>{let e=(0,r.useRouter)(),t=decodeURIComponent(e.query.monitorId),n=decodeURIComponent(e.query.systemId),[d,c]=(0,a.useState)(n===i.Kl?"Uncategorized assets":n);return(0,s.jsxs)(o.Z,{title:"Action center - Discovered assets",children:[(0,s.jsx)(l.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:i.vi},{title:t,href:"".concat(i.vi,"/").concat(t)},{title:n===i.Kl?"Uncategorized assets":d}]}),(0,s.jsx)(J,{monitorId:t,systemId:n,onSystemName:c})]})}},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},18992:function(e){e.exports={cellBleed:"Cells_cellBleed__dik43"}}},function(e){e.O(0,[8765,9278,5163,401,6780,7725,8735,2888,9774,179],function(){return e(e.s=25654)}),_N_E=e.O()}]);