(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{58095:function(e,t,n){var s=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&s(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var s=-1,a=null==e?0:e.length;++s<a;)if(n(t,e[s]))return!0;return!1}},8817:function(e,t,n){var s=n(95372),a=n(1129),o=n(58263);e.exports=function(e,t,n){return t==t?o(e,t,n):s(e,a,n)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,n){var s=n(52485),a=n(58095),o=n(21796),i=n(65581),r=n(47111),l=n(43735);e.exports=function(e,t,n){var d=-1,c=a,u=e.length,m=!0,h=[],g=h;if(n)m=!1,c=o;else if(u>=200){var p=t?null:r(e);if(p)return l(p);m=!1,c=i,g=new s}else g=t?[]:h;e:for(;++d<u;){var y=e[d],x=t?t(y):y;if(y=n||0!==y?y:0,m&&x==x){for(var v=g.length;v--;)if(g[v]===x)continue e;t&&g.push(x),h.push(y)}else c(g,x,n)||(g!==h&&g.push(x),h.push(y))}return h}},47111:function(e,t,n){var s=n(46151),a=n(50344),o=n(43735),i=s&&1/o(new s([,-0]))[1]==1/0?function(e){return new s(e)}:a;e.exports=i},58263:function(e){e.exports=function(e,t,n){for(var s=n-1,a=e.length;++s<a;)if(e[s]===t)return s;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,n){var s=n(92198);e.exports=function(e){return e&&e.length?s(e):[]}},25654:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]/[systemId]",function(){return n(56514)}])},79283:function(e,t,n){"use strict";n.d(t,{l:function(){return l}});var s=n(24246),a=n(13577),o=n(72707),i=n.n(o);let r=e=>{let{data:{formattedTitle:t,description:n,name:o,primaryName:i}}=e;return(0,s.jsxs)(a.jqI,{gap:12,title:"".concat(t," - ").concat(n),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:i||o}),i&&": ".concat(o)]}),(0,s.jsx)("em",{children:n})]})},l=e=>{let{options:t,...n}=e,o=null==t?void 0:t.map(e=>({...e,className:i().option,formattedTitle:[e.primaryName,e.name].filter(e=>e).join(": ")}));return(0,s.jsx)(a.WPr,{options:o,filterOption:(e,t)=>(null==t?void 0:t.formattedTitle.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:t.value.toLowerCase().includes(e.toLowerCase()))||!1,optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:r,dropdownStyle:{minWidth:"500px"},className:"w-full p-0","data-testid":"taxonomy-select",...n})}},14047:function(e,t,n){"use strict";n.d(t,{H:function(){return o},V:function(){return s.V}});var s=n(84306),a=n(812);let o=()=>{let{errorAlert:e}=(0,s.V)();return{handleError:t=>{let n="An unexpected error occurred. Please try again.";(0,a.Ot)(t)?n=t.data.detail:(0,a.tB)(t)&&(n=t.data.detail[0].msg),e(n)}}}},84306:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var s=n(24246),a=n(13577);let o=()=>{let e=(0,a.pmc)();return{errorAlert:(t,n,o)=>{let i={...o,position:(null==o?void 0:o.position)||"top",render:e=>{let{onClose:o}=e;return(0,s.jsxs)(a.bZj,{alignItems:"normal",status:"error","data-testid":"error-alert",children:[(0,s.jsx)(a.zMQ,{}),(0,s.jsxs)(a.xuv,{children:[n&&(0,s.jsx)(a.CdC,{children:n}),(0,s.jsx)(a.XaZ,{children:t})]}),(0,s.jsx)(a.PZ7,{onClick:o,position:"relative",right:0,size:"sm",top:-1})]})}};(null==o?void 0:o.id)&&e.isActive(o.id)?e.update(o.id,i):e(i)},successAlert:(t,n,o)=>{let i={...o,position:(null==o?void 0:o.position)||"top",render:e=>{let{onClose:o}=e;return(0,s.jsxs)(a.bZj,{alignItems:"normal",status:"success",variant:"subtle","data-testid":"success-alert",children:[(0,s.jsx)(a.zMQ,{}),(0,s.jsxs)(a.xuv,{children:[n&&(0,s.jsx)(a.CdC,{children:n}),(0,s.jsx)(a.XaZ,{children:t})]}),(0,s.jsx)(a.PZ7,{onClick:o,position:"relative",right:0,size:"sm",top:-1})]})}};(null==o?void 0:o.id)&&e.isActive(o.id)?e.update(o.id,i):e(i)}}}},45938:function(e,t,n){"use strict";n.d(t,{Gt:function(){return m},eB:function(){return h},oI:function(){return u}});var s=n(24246),a=n(34090),o=n(27378),i=n(16134),r=n(38602),l=n(58452);let d=(0,o.createRef)(),c=(0,o.createRef)(),u=()=>{let e=(0,i.T)(),t=(0,i.C)(r.DB),n=(0,o.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),s=(0,o.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!0),n())},[e,n]),a=(0,o.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!1),n())},[e,n]);return{attemptAction:(0,o.useCallback)(()=>t?(e((0,r.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:s,onClose:a}},m=e=>{let{id:t,name:n}=e,{dirty:s}=(0,a.u6)(),l=(0,i.T)();return(0,o.useEffect)(()=>(l((0,r.Zu)({id:t,name:n})),()=>{l((0,r.dz)({id:t}))}),[l,t,n]),(0,o.useEffect)(()=>{l((0,r.$p)({id:t,isDirty:s}))},[s,l,t]),null},h=()=>{let{onConfirm:e,onClose:t}=u(),n=(0,i.C)(r.uv);return(0,s.jsx)(l.Z,{isOpen:n,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},56514:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var s=n(24246),a=n(86677),o=n(27378),i=n(35287),r=n(77830),l=n(58754),d=n(13577),c=n(83766),u=n.n(c),m=n(812),h=n(25415),g=n(46628),p=n(54682),y=n(30952),x=n(37059),v=n(8133),f=n(79283),j=n(34929),w=n(78238),_=e=>{let{selectedTaxonomies:t,...n}=e,{getDataUseDisplayNameProps:a,getDataUses:o}=(0,j.Z)(),i=o().filter(e=>e.active&&w.g.includes(e.fides_key)).map(e=>{let{name:t,primaryName:n}=a(e.fides_key);return{value:e.fides_key,name:t,primaryName:n,description:e.description||""}});return(0,s.jsx)(f.l,{options:i,...n})};let{Text:C}=d.AntTypography;var b=e=>{let{onSave:t,isSaving:n,onClose:a,...i}=e,[r,l]=(0,o.useState)([]),c=()=>{l([]),a()};return(0,s.jsxs)(v.Z,{title:"Add consent category",...i,onClose:c,children:[(0,s.jsxs)(d.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,s.jsx)(C,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,s.jsx)(_,{mode:"tags",selectedTaxonomies:r,onSelect:(e,t)=>l([...r,t.value]),variant:"outlined"})]}),(0,s.jsxs)(d.jqI,{justify:"space-between",children:[(0,s.jsx)(d.wpx,{htmlType:"reset",onClick:c,"data-testid":"cancel-btn",children:"Cancel"}),(0,s.jsx)(d.wpx,{htmlType:"submit",type:"primary",disabled:!r.length,loading:n,onClick:()=>{t(r),c()},"data-testid":"save-btn",children:"Save"})]})]})},k=n(29850),S=n(77685);let{Text:I}=d.AntTypography,T=e=>{let{onSave:t,isSaving:n,...a}=e,[i,r]=(0,o.useState)(),[l,c]=(0,o.useState)(!1),u=(0,o.useCallback)(e=>{e.preventDefault(),c(!0)},[]),m=()=>{c(!1)},h=()=>{r(void 0),a.onClose()};return(0,s.jsxs)(v.Z,{title:"Assign system",...a,onClose:h,children:[(0,s.jsxs)(d.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,s.jsx)(I,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,s.jsx)(k.R,{placeholder:"Search or select...",onSelect:(e,t)=>{r(t)},onAddSystem:u,value:i})]})," ",(0,s.jsxs)(d.jqI,{justify:"space-between",children:[(0,s.jsx)(d.wpx,{htmlType:"reset",onClick:h,"data-testid":"cancel-btn",children:"Cancel"}),(0,s.jsx)(d.wpx,{htmlType:"submit",type:"primary",disabled:!i,loading:n,onClick:()=>{t(i),h()},"data-testid":"save-btn",children:"Save"})]}),l&&(0,s.jsx)(S.i,{isOpen:!0,onClose:m,onSuccessfulSubmit:(e,t)=>{m(),r({label:t,value:e})},toastOnSuccess:!0})]})};var A=n(8411),E=n(47935);let{Paragraph:L,Text:N,Link:D}=d.AntTypography,O=e=>{var t,n,a;let{isOpen:i,stagedResource:r,status:l,onCancel:c,onDownload:u}=e,[m,h]=(0,o.useState)(1),[g,p]=(0,o.useState)(E.W3[0]),{data:y,isFetching:v,isError:f}=(0,x.mi)({stagedResourceUrn:r.urn,status:l,page:m,size:g}),{items:j,total:w}=(0,o.useMemo)(()=>y||{items:[],total:0,pages:0,filterOptions:{assigned_users:[],systems:[]}},[y]);return(0,s.jsx)(d.$zI,{title:"Consent discovery",width:768,open:i,onCancel:c,footer:[(0,s.jsx)(d.wpx,{onClick:c,children:"Cancel"},"cancel"),!!u&&(0,s.jsx)(d.wpx,{type:"primary",onClick:u,children:"Download"},"download")],"data-testid":"consent-breakdown-modal",children:(0,s.jsxs)(d.jqI,{vertical:!0,className:"gap-6","data-testid":"consent-breakdown-modal-content",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(L,{children:"View all instances where this asset was detected without consent, organized by location and page. Use this to investigate potential compliance issues."}),(0,s.jsxs)(L,{children:[(0,s.jsx)(N,{strong:!0,children:"Asset name:"})," ",null!==(t=r.name)&&void 0!==t?t:(0,s.jsx)(N,{italic:!0,children:"Unknown"}),","," ",(0,s.jsx)(N,{strong:!0,children:"System:"})," ",null!==(n=r.system)&&void 0!==n?n:(0,s.jsx)(N,{italic:!0,children:"Unassigned"}),","," ",(0,s.jsx)(N,{strong:!0,children:"Domain:"})," ",null!==(a=r.domain)&&void 0!==a?a:(0,s.jsx)(N,{italic:!0,children:"Unknown"})]})]}),f?(0,s.jsx)(d.DUx,{type:"error",message:"Error fetching data",description:"Please try again later.",showIcon:!0}):(0,s.jsx)(d.V5H,{columns:[{title:"Location",dataIndex:"location",key:"location",render:e=>{var t;return null!==(t=A.Z8[e])&&void 0!==t?t:e}},{title:"Page",dataIndex:"page",key:"page",render:e=>(0,s.jsx)(D,{href:e,target:"_blank",rel:"noopener noreferrer",children:e})}],rowKey:e=>e.location,dataSource:j,pagination:!!w&&(m>1||g>E.W3[0])&&{current:m,pageSize:g,total:w||0,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items"),onChange:(e,t)=>{h(e),t!==g&&(p(t),h(1))}},loading:v,"data-testid":"consent-breakdown-modal-table"})]})})};var P=n(88708),Z=n(62165),U=n(91982),V=n(54762),R=n(9320);let z=e=>{let{asset:t,onTabChange:n}=e,[o,{isLoading:i}]=(0,x.EY)(),[l,{isLoading:c}]=(0,x.nS)(),[u,{isLoading:h}]=(0,x.Tj)(),y=(0,d.pmc)(),v=(0,a.useRouter)(),f=i||c||h,{urn:j,name:w,resource_type:_,diff_status:C,system_key:b,user_assigned_system_key:k}=t,S=async()=>{let e=await o({urnList:[j]});if((0,m.D4)(e))y((0,g.Vo)((0,m.e$)(e.error)));else{let e=k||b,t="".concat(r.So,"/configure/").concat(e,"#assets");y((0,g.t5)((0,R._)("".concat(_,' "').concat(w,'" has been added to the system inventory.'),e?()=>v.push(t):void 0)))}},I=async()=>{let e=await l({urnList:[j]});(0,m.D4)(e)?y((0,g.Vo)((0,m.e$)(e.error))):y((0,g.t5)((0,R._)("".concat(_,' "').concat(w,'" has been ignored and will not appear in future scans.'),()=>n(P.A.IGNORED))))},T=async()=>{let e=await u({urnList:[j]});(0,m.D4)(e)?y((0,g.Vo)((0,m.e$)(e.error))):y((0,g.t5)("".concat(_,' "').concat(w,'" is no longer ignored and will appear in future scans.')))};return(0,s.jsxs)(d.vyj,{children:[C!==p.LL.MUTED&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.esZ,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,s.jsx)(d.wpx,{"data-testid":"add-btn",size:"small",onClick:S,disabled:!t.system||f,loading:i,children:"Add"})}),(0,s.jsx)(d.wpx,{"data-testid":"ignore-btn",size:"small",onClick:I,disabled:f,loading:c,children:"Ignore"})]}),C===p.LL.MUTED&&(0,s.jsx)(d.wpx,{"data-testid":"restore-btn",size:"small",onClick:T,disabled:f,loading:h,children:"Restore"})]})};var M=n(14047),W=n(18992),$=n.n(W),B=n(31883),q=e=>{var t;let{asset:n,readonly:a}=e,[i,r]=(0,o.useState)(!1),[l]=(0,x.Ak)(),{successAlert:c,errorAlert:u}=(0,M.V)(),{getDataUseDisplayName:h}=(0,j.Z)(),g=n.user_assigned_data_uses||n.data_uses||[],p=async e=>{let t=await l({monitorId:n.monitor_config_id,urnList:[n.urn],dataUses:[...g,e]});(0,B.D4)(t)?u((0,m.e$)(t.error)):c("Consent category added to ".concat(n.resource_type,' "').concat(n.name,'" .'),"Confirmed"),r(!1)},y=async e=>{let t=await l({monitorId:n.monitor_config_id,urnList:[n.urn],dataUses:g.filter(t=>t!==e)});(0,B.D4)(t)?u((0,m.e$)(t.error)):c("Consent category removed from ".concat(n.resource_type,' "').concat(n.name,'".'),"Confirmed")},v=(null===(t=n.user_assigned_data_uses)||void 0===t?void 0:t.length)?n.user_assigned_data_uses:n.data_uses,f=null==v?void 0:v.filter(e=>(0,w.Z)(e));return a?(0,s.jsx)(d.vyj,{direction:"vertical",children:null==f?void 0:f.map(e=>(0,s.jsx)(d.j8w,{color:"white",children:h(e)},e))}):(0,s.jsxs)(s.Fragment,{children:[!i&&(0,s.jsxs)(d.vyj,{wrap:!0,children:[null==f?void 0:f.map(e=>(0,s.jsx)(d.j8w,{"data-testid":"data-use-".concat(e),color:"white",closable:!0,onClose:()=>y(e),closeButtonLabel:"Remove data use",children:h(e)},e)),(0,s.jsx)(d.j8w,{onClick:()=>r(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"})]}),i&&(0,s.jsx)("div",{className:$().cellBleed,style:{backgroundColor:"var(--fides-color-white)"},children:(0,s.jsx)(_,{selectedTaxonomies:f||[],onSelect:p,onBlur:()=>r(!1),open:!0})})]})};let K=e=>{let{consentAggregated:t,stagedResource:n,onShowBreakdown:a}=e;return(0,s.jsxs)(s.Fragment,{children:[t===p.lg.WITHOUT_CONSENT&&(0,s.jsx)(d.esZ,{title:"Asset was detected before the user gave consent or without any consent. Click the info icon for more details.",children:(0,s.jsx)(d.j8w,{color:"error",closeIcon:(0,s.jsx)(d.PJP.daM,{style:{width:12,height:12}}),closeButtonLabel:"View details",onClose:()=>{null==a||a(n,t)},"data-testid":"status-badge_without-consent",children:"Without consent"})}),t===p.lg.WITH_CONSENT&&(0,s.jsx)(d.esZ,{title:"Asset was detected after the user gave consent",children:(0,s.jsx)(d.j8w,{color:"success","data-testid":"status-badge_with-consent",children:"With consent"})}),t===p.lg.EXEMPT&&(0,s.jsx)(d.esZ,{title:"Asset is valid regardless of consent",children:(0,s.jsx)(d.j8w,{"data-testid":"status-badge_consent-exempt",children:"Consent exempt"})}),t===p.lg.UNKNOWN&&(0,s.jsx)(d.esZ,{title:"Did not find consent information for this asset. You may need to re-run the monitor.",children:(0,s.jsx)(d.j8w,{"data-testid":"status-badge_unknown",children:"Unknown"})})]})};var F=n(70675);let H=e=>{let{aggregateSystem:t,monitorConfigId:n,readonly:a}=e,{resource_type:i,name:r,urn:l,system:c,user_assigned_system_key:u,system_key:h}=t,[g,p]=(0,o.useState)(!1),[y,x]=(0,o.useState)(!1),[v,{isLoading:f}]=(0,F.NA)(),{successAlert:j,errorAlert:w}=(0,M.V)(),_=(0,o.useCallback)(e=>{e.preventDefault(),x(!0)},[]),C=async(e,t,s)=>{let a=await v({staged_resource_urn:l,monitor_config_id:n,user_assigned_system_key:e});(0,m.D4)(a)?w((0,m.e$)(a.error)):j(s?"".concat(t," has been added to your system inventory and the ").concat(i,' "').concat(r,'" has been assigned to that system.'):"".concat(i,' "').concat(r,'" has been assigned to ').concat(t,"."),"Confirmed"),p(!1)};return a?c?(0,s.jsx)(d.j8w,{"data-testid":"system-badge",color:"white",children:c}):null:(0,s.jsxs)(s.Fragment,{children:[!g&&(c?(0,s.jsxs)(d.j8w,{onClick:()=>p(!0),"data-testid":"system-badge",children:[c,(0,s.jsx)(d.PJP.I8b,{})]}):(0,s.jsx)(d.j8w,{onClick:()=>p(!0),"data-testid":"add-system-btn",addable:!0})),!!g&&(0,s.jsx)("div",{className:$().cellBleed,children:(0,s.jsx)(k.R,{variant:"borderless",autoFocus:!0,defaultOpen:!0,defaultValue:u||h,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&p(!1)},onAddSystem:_,onSelect:(e,t)=>C(e,t.label),loading:f})}),y&&(0,s.jsx)(S.i,{isOpen:!0,onClose:()=>{x(!1)},onSuccessfulSubmit:(e,t)=>C(e,t,!0)})]})},X=e=>{let{readonly:t,aggregatedConsent:n,onTabChange:a,onShowBreakdown:i}=e,{flags:r}=(0,Z.hz)(),{assetConsentStatusLabels:l}=r,[c,u]=(0,o.useState)(!1),[m,h]=(0,o.useState)(!1);return{columns:(0,o.useMemo)(()=>{let e=[{title:"Asset",dataIndex:"name",key:"name",render:e=>(0,s.jsx)(d.lKn,{ellipsis:{tooltip:!0},style:{maxWidth:300},children:e}),fixed:"left"},{title:"Type",dataIndex:"resource_type",key:"resource_type"},{title:"System",dataIndex:"system",key:"system",width:200,render:(e,n)=>!!n.monitor_config_id&&(0,s.jsx)(H,{aggregateSystem:n,monitorConfigId:n.monitor_config_id,readonly:t})},{title:"Categories of consent",key:"data_use",width:400,render:(e,n)=>(0,s.jsx)(q,{asset:n,readonly:t})},{title:()=>(0,s.jsx)(U.OL,{title:"Locations",menu:{items:U.DI,onClick:e=>{"expand-all"===e.key?u(!0):"collapse-all"===e.key&&u(!1)}}}),dataIndex:"locations",key:"locations",width:250,render:e=>{var t;return(0,s.jsx)(U.Q3,{values:null!==(t=null==e?void 0:e.map(e=>{var t;return{label:null!==(t=A.Z8[e])&&void 0!==t?t:e,key:e}}))&&void 0!==t?t:[],columnState:{isExpanded:c,isWrapped:!0}})}},{title:"Domain",dataIndex:"domain",key:"domain"},{title:()=>(0,s.jsx)(U.OL,{title:"Detected on",menu:{items:U.DI,onClick:e=>{"expand-all"===e.key?h(!0):"collapse-all"===e.key&&h(!1)}}}),dataIndex:"page",key:"page",render:e=>(0,s.jsx)(U.vx,{values:e,valueSuffix:"pages",columnState:{isExpanded:m}})}];return l&&e.push({title:()=>(0,s.jsxs)(d.vyj,{children:[(0,s.jsx)("div",{children:"Discovery"}),n===p.lg.WITHOUT_CONSENT&&(0,s.jsx)(V.l,{consentStatus:{status:p.pF.ALERT,message:"One or more assets were detected without consent"}})]}),dataIndex:"consent_aggregated",key:"consent_aggregated",render:(e,t)=>(0,s.jsx)(K,{consentAggregated:null!=e?e:p.lg.UNKNOWN,stagedResource:t,onShowBreakdown:i})}),t||e.push({title:"Actions",key:"actions",fixed:"right",render:(e,t)=>(0,s.jsx)(z,{asset:t,onTabChange:a})}),e},[t,l,n,a,i,c,m])}},Y=e=>{var t;let{monitorId:n,systemId:i,onSystemName:l}=e,c=(0,a.useRouter)(),[v,f]=(0,o.useState)(),[j,w]=(0,o.useState)(i),[_,C]=(0,o.useState)(1),[k,S]=(0,o.useState)(25),[I,A]=(0,o.useState)([]),[E,L]=(0,o.useState)(new Map),N=()=>{A([]),L(new Map)},[D,Z]=(0,o.useState)(!1),[U,V]=(0,o.useState)(!1),[z,M]=(0,o.useState)(null),[W,{isLoading:$}]=(0,x.EY)(),[B,{isLoading:q}]=(0,x.nS)(),[K,{isLoading:F}]=(0,x.rs)(),[H,{isLoading:Y}]=(0,x.sX)(),[J,{isLoading:G}]=(0,x.Vr)(),[Q,{isLoading:ee}]=(0,x.Tj)(),et=$||q||F||Y||ee,en=et||i===r.Kl,[es,ea]=(0,o.useState)(""),eo=(0,d.pmc)();(0,o.useEffect)(()=>{C(1)},[n,es]);let{filterTabs:ei,activeTab:er,onTabChange:el,activeParams:ed,actionsDisabled:ec}=(0,P.Z)(i);(0,o.useEffect)(()=>{C(1)},[n,es,er]),(0,o.useEffect)(()=>{N()},[n,es,er]);let{data:eu,isLoading:em,isFetching:eh}=(0,x.WJ)({key:n,page:_,size:k,search:es,...ed});(0,o.useEffect)(()=>{if(eu){var e;let t=(null===(e=eu.items[0])||void 0===e?void 0:e.system)||j||i||"";w(t),null==l||l(t)}},[eu,i,l,j]),(0,o.useEffect)(()=>{if((null==eu?void 0:eu.items)&&!v){var e;f(null===(e=eu.items.find(e=>e.consent_aggregated===p.lg.WITHOUT_CONSENT))||void 0===e?void 0:e.consent_aggregated)}},[eu,v]);let{columns:eg}=X({readonly:null!=ec&&ec,onTabChange:el,aggregatedConsent:v,onShowBreakdown:(e,t)=>{M({stagedResource:e,status:t})}}),ep=Array.from(E.keys()),ey=Array.from(E.values()),ex=async()=>{var e,t;let n=await W({urnList:ep}),s=(null===(e=ey[0])||void 0===e?void 0:e.user_assigned_system_key)||(null===(t=ey[0])||void 0===t?void 0:t.system_key),a=ey.every(e=>(e.user_assigned_system_key||e.system_key)===s)?s:void 0;(0,m.D4)(n)?eo((0,g.Vo)((0,m.e$)(n.error))):(eo((0,g.t5)((0,R._)("".concat(ep.length," assets from ").concat(j," have been added to the system inventory."),a?()=>c.push("".concat(r.So,"/configure/").concat(a,"#assets")):()=>c.push(r.So)))),N())},ev=async e=>{if("string"==typeof(null==e?void 0:e.value)){let t=await H({monitorId:n,urnList:ep,systemKey:e.value});(0,m.D4)(t)?eo((0,g.Vo)((0,m.e$)(t.error))):eo((0,g.t5)("".concat(ep.length," assets have been assigned to ").concat(e.label,"."),"Confirmed"))}Z(!1)},ef=async e=>{if(!ey.length)return;let t=ey.map(t=>{let n=u()([...t.user_assigned_data_uses||t.data_uses||[],...e]);return{urn:t.urn,user_assigned_data_uses:n}}),s=await J({monitorId:n,assets:t});(0,m.D4)(s)?eo((0,g.Vo)((0,m.e$)(s.error))):eo((0,g.t5)("Consent categories added to ".concat(ep.length," assets").concat(j?" from ".concat(j):"","."),"Confirmed")),V(!1)},ej=async()=>{let e=await B({urnList:ep});(0,m.D4)(e)?eo((0,g.Vo)((0,m.e$)(e.error))):(eo((0,g.t5)(j===r.Kl?"".concat(ep.length," uncategorized assets have been ignored and will not appear in future scans."):"".concat(ep.length," assets from ").concat(j," have been ignored and will not appear in future scans."),"Confirmed")),N())},ew=async()=>{let e=await Q({urnList:ep});(0,m.D4)(e)?eo((0,g.Vo)((0,m.e$)(e.error))):(eo((0,g.t5)("".concat(ep.length," assets have been restored and will appear in future scans."),"Confirmed")),N())},e_=async()=>{let e=(null==eu?void 0:eu.items.length)||0,t=await K({monitor_config_key:n,resolved_system_ids:[i]});(0,m.D4)(t)?eo((0,g.Vo)((0,m.e$)(t.error))):(c.push("".concat(r.vi,"/").concat(n)),eo((0,g.t5)("".concat(e," assets from ").concat(j," have been added to the system inventory."),"Confirmed")),N())},eC=e=>{el(e),N()};return((0,o.useEffect)(()=>{(null==eu?void 0:eu.items)&&A(eu.items.filter(e=>E.has(e.urn)).map(e=>e.urn))},[eu,E]),n&&i)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A5g,{items:ei.map(e=>({key:e.hash,label:e.label})),activeKey:er,onChange:e=>eC(e)}),(0,s.jsxs)(d.jqI,{justify:"space-between",align:"center",className:"mb-4",children:[(0,s.jsx)(y.f,{value:es,onChange:ea,placeholder:"Search by asset name..."}),(0,s.jsxs)(d.vyj,{size:"large",children:[!!ep.length&&(0,s.jsx)(h.a,{count:ep.length}),(0,s.jsxs)(d.vyj,{size:"small",children:[(0,s.jsx)(d.S0p,{menu:{items:[{key:"add",label:"Add",onClick:ex},{key:"add-data-use",label:"Add consent category",onClick:()=>V(!0)},{key:"assign-system",label:"Assign system",onClick:()=>Z(!0)},...(null==ed?void 0:null===(t=ed.diff_status)||void 0===t?void 0:t.includes(p.LL.MUTED))?[{key:"restore",label:"Restore",onClick:ew}]:[{type:"divider"},{key:"ignore",label:"Ignore",onClick:ej}]]},trigger:["click"],children:(0,s.jsx)(d.wpx,{icon:(0,s.jsx)(d.PJP._ME,{}),iconPosition:"end",loading:et,"data-testid":"bulk-actions-menu",disabled:!ep.length||et||ec,type:"primary",children:"Actions"})}),(0,s.jsx)(d.esZ,{title:en?"These assets require a system before you can add them to the inventory.":void 0,children:(0,s.jsx)(d.wpx,{onClick:e_,disabled:en,loading:F,type:"primary",icon:(0,s.jsx)(d.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,s.jsx)(d.V5H,{dataSource:(null==eu?void 0:eu.items)||[],columns:eg,loading:em||eh,rowKey:e=>e.urn,rowSelection:er===P.A.RECENT_ACTIVITY?void 0:{selectedRowKeys:I,onChange:(e,t)=>{A(e);let n=new Map(E);(null==eu?void 0:eu.items)&&eu.items.forEach(t=>{e.includes(t.urn)||n.delete(t.urn)}),t.forEach(e=>{n.set(e.urn,e)}),L(n)}},pagination:{current:_,pageSize:k,total:(null==eu?void 0:eu.total)||0},onChange:e=>{C(e.current),S(e.pageSize)},locale:{emptyText:(0,s.jsx)(d.oj8,{image:d.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}}),(0,s.jsx)(T,{isOpen:D,onClose:()=>{Z(!1)},onSave:ev,isSaving:Y}),(0,s.jsx)(b,{isOpen:U,onClose:()=>{V(!1)},onSave:ef,isSaving:G}),z&&(0,s.jsx)(O,{isOpen:!!z,stagedResource:z.stagedResource,status:z.status,onCancel:()=>{M(null)}})]}):null};var J=()=>{let e=(0,a.useRouter)(),t=decodeURIComponent(e.query.monitorId),n=decodeURIComponent(e.query.systemId),[d,c]=(0,o.useState)(n===r.Kl?"Uncategorized assets":n);return(0,s.jsxs)(i.Z,{title:"Action center - Discovered assets",children:[(0,s.jsx)(l.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:r.vi},{title:t,href:"".concat(r.vi,"/").concat(t)},{title:n===r.Kl?"Uncategorized assets":d}]}),(0,s.jsx)(Y,{monitorId:t,systemId:n,onSystemName:c})]})}},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},18992:function(e){e.exports={cellBleed:"Cells_cellBleed__dik43"}}},function(e){e.O(0,[8765,9278,5163,401,6780,8237,2888,9774,179],function(){return e(e.s=25654)}),_N_E=e.O()}]);