#!/usr/bin/env python3
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≥–æ, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ Excel –¥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î.
"""

def demo_excel_to_database_workflow():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ø–∞—Ä—Å–∏–Ω–≥–∞ Excel –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î.
    """
    print("=" * 70)
    print("–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø: –ü–ê–†–°–ò–ù–ì EXCEL –ò –°–û–•–†–ê–ù–ï–ù–ò–ï –í –ë–ê–ó–£ –î–ê–ù–ù–´–•")
    print("=" * 70)
    
    print("\nüéØ –ü–†–û–ë–õ–ï–ú–ê:")
    print("   –ö–æ–≥–¥–∞ –ø–∞—Ä—Å—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel, –∏—Ö –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö .db,")
    print("   –Ω–æ —Å–µ–π—á–∞—Å MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–¥–µ–ª—å–Ω–æ.")
    
    print("\n‚úÖ –†–ï–®–ï–ù–ò–ï:")
    print("   –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è parse_excel_and_save_to_database(), –∫–æ—Ç–æ—Ä–∞—è:")
    print("   1. –ü–∞—Ä—Å–∏—Ç Excel —Ñ–∞–π–ª")
    print("   2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–≤–∞—Ä—ã –≤ SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö")
    print("   3. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∫–æ–¥–∞")
    print("   4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É")
    
    print("\nüìã –†–ê–ë–û–ß–ò–ô –ü–†–û–¶–ï–°–°:")
    
    # –®–∞–≥ 1: –ü–∞—Ä—Å–∏–Ω–≥ Excel
    print("\n   –®–∞–≥ 1: –ü–∞—Ä—Å–∏–Ω–≥ Excel —Ñ–∞–π–ª–∞")
    print("   ‚îú‚îÄ –§—É–Ω–∫—Ü–∏—è: parse_excel_file()")
    print("   ‚îú‚îÄ –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: data/test_products.xlsx")
    print("   ‚îú‚îÄ –õ–∏—Å—Ç: '–¢–æ–≤–∞—Ä—ã'")
    print("   ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: 3 —Ç–æ–≤–∞—Ä–∞ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–æ")
    
    # –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel
    excel_data = [
        {
            "–ö–æ–¥\n–º–æ–¥–µ–ª–∏": 195385,
            "model_name": "–ü–æ–ª–æ—Ç–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ë–Ø–ó–¨ –û–¢–ë–ï–õ–ï–ù–ù–ê–Ø –ì–û–°–¢, —Ä—É–ª–æ–Ω 1,5—Ö50 –º",
            "–ö–∞—Ç–µ–≥–æ—Ä–∏—è": "–•–æ–∑—Ç–æ–≤–∞—Ä—ã –∏ –ø–æ—Å—É–¥–∞",
            "–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è": "–º",
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \n1 –ò—Å—Ç–æ—á–Ω–∏–∫–∏": "–ö–æ–º—É—Å",
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \n2 –ò—Å—Ç–æ—á–Ω–∏–∫–∏": "–í—Å–µ–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã"
        },
        {
            "–ö–æ–¥\n–º–æ–¥–µ–ª–∏": 195386,
            "model_name": "–ë—É–º–∞–≥–∞ –æ—Ñ–∏—Å–Ω–∞—è –ê4 80–≥/–º2, –ø–∞—á–∫–∞ 500 –ª–∏—Å—Ç–æ–≤",
            "–ö–∞—Ç–µ–≥–æ—Ä–∏—è": "–ö–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã",
            "–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è": "–ø–∞—á–∫–∞",
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \n1 –ò—Å—Ç–æ—á–Ω–∏–∫–∏": "–û—Ñ–∏—Å–º–∞–≥",
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \n2 –ò—Å—Ç–æ—á–Ω–∏–∫–∏": "–ö–æ–º—É—Å"
        },
        {
            "–ö–æ–¥\n–º–æ–¥–µ–ª–∏": 195387,
            "model_name": "–†—É—á–∫–∞ —à–∞—Ä–∏–∫–æ–≤–∞—è —Å–∏–Ω—è—è 0.7–º–º",
            "–ö–∞—Ç–µ–≥–æ—Ä–∏—è": "–ö–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã",
            "–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è": "—à—Ç",
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \n1 –ò—Å—Ç–æ—á–Ω–∏–∫–∏": "–ö–æ–º—É—Å",
            "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \n2 –ò—Å—Ç–æ—á–Ω–∏–∫–∏": "–û—Ñ–∏—Å–º–∞–≥"
        }
    ]
    
    print("\n   üìä –ü—Ä–∏–º–µ—Ä —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:")
    for i, item in enumerate(excel_data, 1):
        print(f"      {i}. –ö–æ–¥: {item['–ö–æ–¥\n–º–æ–¥–µ–ª–∏']} | {item['model_name'][:40]}...")
    
    # –®–∞–≥ 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    print("\n   –®–∞–≥ 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö SQLite")
    print("   ‚îú‚îÄ –§—É–Ω–∫—Ü–∏—è: database_manager.save_product()")
    print("   ‚îú‚îÄ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ~/.offers_check_marketplaces/database.db")
    print("   ‚îú‚îÄ –¢–∞–±–ª–∏—Ü–∞: products")
    print("   ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: 3 —Ç–æ–≤–∞—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ")
    
    # –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print("\n   –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤")
    print("   ‚îú‚îÄ –§—É–Ω–∫—Ü–∏—è: get_product_list()")
    print("   ‚îú‚îÄ –§—É–Ω–∫—Ü–∏—è: get_statistics()")
    print("   ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –¢–æ–≤–∞—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ü–µ–Ω")
    
    print("\nüîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:")
    print("   ‚îú‚îÄ –§–∞–π–ª: offers_check_marketplaces/server.py")
    print("   ‚îú‚îÄ –§—É–Ω–∫—Ü–∏—è: parse_excel_and_save_to_database()")
    print("   ‚îú‚îÄ –î–µ–∫–æ—Ä–∞—Ç–æ—Ä: @mcp.tool()")
    print("   ‚îî‚îÄ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: @handle_errors()")
    
    print("\nüìù –°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•:")
    print("   –¢–∞–±–ª–∏—Ü–∞: products")
    print("   ‚îú‚îÄ id (INTEGER PRIMARY KEY)")
    print("   ‚îú‚îÄ code (REAL UNIQUE) - –∏–∑ –ø–æ–ª—è '–ö–æ–¥\\n–º–æ–¥–µ–ª–∏'")
    print("   ‚îú‚îÄ model_name (TEXT) - –∏–∑ –ø–æ–ª—è 'model_name'")
    print("   ‚îú‚îÄ category (TEXT) - –∏–∑ –ø–æ–ª—è '–ö–∞—Ç–µ–≥–æ—Ä–∏—è'")
    print("   ‚îú‚îÄ unit (TEXT) - –∏–∑ –ø–æ–ª—è '–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è'")
    print("   ‚îú‚îÄ priority_1_source (TEXT) - –∏–∑ –ø–æ–ª—è '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \\n1 –ò—Å—Ç–æ—á–Ω–∏–∫–∏'")
    print("   ‚îú‚îÄ priority_2_source (TEXT) - –∏–∑ –ø–æ–ª—è '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç \\n2 –ò—Å—Ç–æ—á–Ω–∏–∫–∏'")
    print("   ‚îú‚îÄ created_at (TIMESTAMP)")
    print("   ‚îî‚îÄ updated_at (TIMESTAMP)")
    
    print("\nüéØ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï:")
    print("   MCP Tool: parse_excel_and_save_to_database")
    print("   –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:")
    print("   ‚îú‚îÄ file_path: 'data/test_products.xlsx'")
    print("   ‚îú‚îÄ sheet_name: '–¢–æ–≤–∞—Ä—ã' (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)")
    print("   ‚îú‚îÄ header_row: 0 (–Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤)")
    print("   ‚îî‚îÄ max_rows: None (–≤—Å–µ —Å—Ç—Ä–æ–∫–∏)")
    
    print("\nüìä –ü–†–ò–ú–ï–† –û–¢–í–ï–¢–ê:")
    example_response = {
        "status": "success",
        "message": "–£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ 3 —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel —Ñ–∞–π–ª–∞",
        "file_path": "data/test_products.xlsx",
        "total_rows_parsed": 3,
        "products_created": 3,
        "products_updated": 0,
        "total_processed": 3,
        "products_saved": [
            {
                "code": 195385,
                "model_name": "–ü–æ–ª–æ—Ç–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ë–Ø–ó–¨ –û–¢–ë–ï–õ–ï–ù–ù–ê–Ø –ì–û–°–¢...",
                "action": "created",
                "id": 1
            }
        ]
    }
    
    print("   {")
    print(f'     "status": "{example_response["status"]}",')
    print(f'     "message": "{example_response["message"]}",')
    print(f'     "total_rows_parsed": {example_response["total_rows_parsed"]},')
    print(f'     "products_created": {example_response["products_created"]},')
    print(f'     "products_updated": {example_response["products_updated"]},')
    print(f'     "total_processed": {example_response["total_processed"]}')
    print("   }")
    
    print("\nüîÑ –î–ê–õ–¨–ù–ï–ô–®–ò–ô –†–ê–ë–û–ß–ò–ô –ü–†–û–¶–ï–°–°:")
    print("   –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –≤ –ë–î:")
    print("   1. get_product_list() - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤")
    print("   2. search_products(model_name) - –Ω–∞–π—Ç–∏ —Ü–µ–Ω—ã –¥–ª—è —Ç–æ–≤–∞—Ä–∞")
    print("   3. save_product_prices(code, results) - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ü–µ–Ω—ã")
    print("   4. get_statistics() - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ü–µ–Ω–∞–º")
    print("   5. export_to_excel() - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã")
    
    print("\n" + "=" * 70)
    print("‚úÖ –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –†–ï–®–ê–ï–¢ –ü–†–û–ë–õ–ï–ú–£ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò EXCEL –ò –ë–î!")
    print("=" * 70)
    
    print("\nüí° –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:")
    print("   ‚úì –û–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")
    print("   ‚úì –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤")
    print("   ‚úì –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫")
    print("   ‚úì –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ Excel")
    print("   ‚úì –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–∏—Å–∫–∞ —Ü–µ–Ω")

if __name__ == "__main__":
    demo_excel_to_database_workflow()