#!/usr/bin/env python3
"""
Создает тестовый Excel файл для проверки новой функции.
"""

import pandas as pd
from pathlib import Path

def create_test_excel():
    """Создает тестовый Excel файл с товарами."""
    test_data = [
        {
            "Код\nмодели": 195385.0,
            "model_name": "Полотно техническое БЯЗЬ ОТБЕЛЕННАЯ ГОСТ, рулон 1,5х50 м",
            "Категория": "Хозтовары и посуда",
            "Единица измерения": "м",
            "Приоритет \n1 Источники": "Комус",
            "Приоритет \n2 Источники": "ВсеИнструменты",
            "Цена позиции\nМП c НДС": "",
            "Цена позиции\nB2C c НДС": "",
            "Дельта в процентах": "",
            "Ссылка на источник": "",
            "Цена 2 позиции\nB2C c НДС": ""
        },
        {
            "Код\nмодели": 195386.0,
            "model_name": "Бумага офисная А4 80г/м2, пачка 500 листов",
            "Категория": "Канцелярские товары",
            "Единица измерения": "пачка",
            "Приоритет \n1 Источники": "Офисмаг",
            "Приоритет \n2 Источники": "Комус",
            "Цена позиции\nМП c НДС": "",
            "Цена позиции\nB2C c НДС": "",
            "Дельта в процентах": "",
            "Ссылка на источник": "",
            "Цена 2 позиции\nB2C c НДС": ""
        },
        {
            "Код\nмодели": 195387.0,
            "model_name": "Ручка шариковая синяя 0.7мм",
            "Категория": "Канцелярские товары",
            "Единица измерения": "шт",
            "Приоритет \n1 Источники": "Комус",
            "Приоритет \n2 Источники": "Офисмаг",
            "Цена позиции\nМП c НДС": "",
            "Цена позиции\nB2C c НДС": "",
            "Дельта в процентах": "",
            "Ссылка на источник": "",
            "Цена 2 позиции\nB2C c НДС": ""
        }
    ]
    
    # Создаем директорию data если не существует
    data_dir = Path("data")
    data_dir.mkdir(exist_ok=True)
    
    # Создаем Excel файл
    test_file_path = data_dir / "test_products.xlsx"
    df = pd.DataFrame(test_data)
    
    # Используем openpyxl engine для создания Excel файла
    with pd.ExcelWriter(test_file_path, engine='openpyxl') as writer:
        df.to_excel(writer, index=False, sheet_name="Товары")
    
    print(f"✅ Создан тестовый Excel файл: {test_file_path}")
    print(f"   Содержит {len(test_data)} товаров")
    print(f"   Размер файла: {test_file_path.stat().st_size} байт")
    
    return str(test_file_path)

if __name__ == "__main__":
    create_test_excel()