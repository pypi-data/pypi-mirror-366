import{_ as me}from"./ConfirmDialog-BLu1kBWp.js";import{k as pe,b as se,m as W,o as S,G as L,F as T,e as v,t as f,f as _,c as C,w as c,H as M,q as re,a as l,l as x,v as R,x as $,y as ve,h as b,D as fe,J as ye,I as P,S as Ve,T as Se,B as q,U as be,V as oe,W as ke,X as Q,Y as ge,Z as he,$ as _e,g as H,a0 as xe,a1 as we,a2 as Ie,a3 as Ce}from"./index-BCUdq-Zu.js";import{a as F,V as ie}from"./VRow-DgX40uiD.js";import{V as A,h as ee,i as Pe,R as te,j as $e,k as Be,d as Ae,f as We,l as Te,n as je,o as Fe,p as Le}from"./VAvatar-DbAmPjyA.js";import{u as D}from"./tag-DCSJ2lri.js";import{V as ae,m as Re,a as le,b as De}from"./VWindowItem-p9SJ1V9Y.js";import{V as Ee}from"./VContainer-B8HjqhNU.js";import{V as ne,m as Ge}from"./VSheet-C8P69LA8.js";import{c as Ne}from"./forwardRefs-Cn7kyt_f.js";const Oe={class:"subtitle mt-4 d-flex"},ze={class:"text-h6"},He=["onClick"],Me={class:"text-grey"},Ue={__name:"CreationSummary",props:{sections:{type:Array,default:()=>[]}},emits:["modify-step"],setup(e,{emit:y}){const{$gettext:t}=se(),a=y;function u(s){return s.length?s.join(", "):t("Empty")}return(s,o)=>(S(!0),W(T,null,L(e.sections,(d,p)=>(S(),W(T,{key:p},[v("div",Oe,[v("span",ze,f(d.title),1),v("a",{href:"#",class:"edit-link ml-auto",onClick:n=>a("modify-step",p+1)},f(_(t)("Modify")),9,He)]),(S(!0),W(T,null,L(d.items,(n,m)=>(S(),C(ie,{key:m,dense:""},{default:c(()=>[n.value!==void 0?M(s.$slots,`item.${n.name}`,{key:0,item:n,displayList:u},()=>[l(F,null,{default:c(()=>[v("span",Me,f(n.key),1)]),_:2},1024),n.type==="yesno"?(S(),C(F,{key:0,class:"text-right"},{default:c(()=>[x(f(s.$yesno(n.value)),1)]),_:2},1024)):n.type==="list"?(S(),C(F,{key:1,class:"text-right"},{default:c(()=>[x(f(u(n.value)),1)]),_:2},1024)):(S(),C(F,{key:2,class:"text-right"},{default:c(()=>[x(f(n.value),1)]),_:2},1024))],!0):re("",!0)]),_:2},1024))),128))],64))),128))}},Ye=pe(Ue,[["__scopeId","data-v-6e743e1a"]]),J=Symbol.for("vuetify:v-stepper"),ue=$({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),qe=R()({name:"VStepperActions",props:ue(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(e,y){let{emit:t,slots:a}=y;const{t:u}=ve();function s(){t("click:prev")}function o(){t("click:next")}return D(()=>{const d={onClick:s},p={onClick:o};return v("div",{class:"v-stepper-actions"},[l(ee,{defaults:{VBtn:{disabled:["prev",!0].includes(e.disabled),text:u(e.prevText),variant:"text"}}},{default:()=>{var n;return[((n=a.prev)==null?void 0:n.call(a,{props:d}))??l(A,d,null)]}}),l(ee,{defaults:{VBtn:{color:e.color,disabled:["next",!0].includes(e.disabled),text:u(e.nextText),variant:"tonal"}}},{default:()=>{var n;return[((n=a.next)==null?void 0:n.call(a,{props:p}))??l(A,p,null)]}})])}),{}}}),ce=Pe("v-stepper-header"),Je=$({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:P,default:"$complete"},editable:Boolean,editIcon:{type:P,default:"$edit"},error:Boolean,errorIcon:{type:P,default:"$error"},icon:P,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),Xe=$({...Je(),...Te()},"VStepperItem"),U=R()({name:"VStepperItem",directives:{vRipple:te},props:Xe(),emits:{"group:selected":e=>!0},setup(e,y){let{slots:t}=y;const a=$e(e,J,!0),u=b(()=>(a==null?void 0:a.value.value)??e.value),s=b(()=>e.rules.every(I=>I()===!0)),o=b(()=>!e.disabled&&e.editable),d=b(()=>!e.disabled&&e.editable),p=b(()=>e.error||!s.value),n=b(()=>e.complete||e.rules.length>0&&s.value),m=b(()=>p.value?e.errorIcon:n.value?e.completeIcon:a.isSelected.value&&e.editable?e.editIcon:e.icon),w=b(()=>({canEdit:d.value,hasError:p.value,hasCompleted:n.value,title:e.title,subtitle:e.subtitle,step:u.value,value:e.value}));return D(()=>{var r,i,h;const I=(!a||a.isSelected.value||n.value||d.value)&&!p.value&&!e.disabled,j=!!(e.title!=null||t.title),V=!!(e.subtitle!=null||t.subtitle);function k(){a==null||a.toggle()}return fe(v("button",{class:ye(["v-stepper-item",{"v-stepper-item--complete":n.value,"v-stepper-item--disabled":e.disabled,"v-stepper-item--error":p.value},a==null?void 0:a.selectedClass.value]),disabled:!e.editable,type:"button",onClick:k},[o.value&&Be(!0,"v-stepper-item"),l(We,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:I?e.color:void 0,size:24},{default:()=>{var g;return[((g=t.icon)==null?void 0:g.call(t,w.value))??(m.value?l(Ae,{icon:m.value},null):u.value)]}}),v("div",{class:"v-stepper-item__content"},[j&&v("div",{key:"title",class:"v-stepper-item__title"},[((r=t.title)==null?void 0:r.call(t,w.value))??e.title]),V&&v("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((i=t.subtitle)==null?void 0:i.call(t,w.value))??e.subtitle]),(h=t.default)==null?void 0:h.call(t,w.value)])]),[[te,e.ripple&&e.editable,null]])}),{}}}),Ze=$({...be(Re(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),de=R()({name:"VStepperWindow",props:Ze(),emits:{"update:modelValue":e=>!0},setup(e,y){let{slots:t}=y;const a=Ve(J,null),u=Se(e,"modelValue"),s=b({get(){var o;return u.value!=null||!a?u.value:(o=a.items.value.find(d=>a.selected.value.includes(d.id)))==null?void 0:o.value},set(o){u.value=o}});return D(()=>{const o=ae.filterProps(e);return l(ae,q({_as:"VStepperWindow"},o,{modelValue:s.value,"onUpdate:modelValue":d=>s.value=d,class:["v-stepper-window",e.class],style:e.style,mandatory:!1,touch:!1}),t)}),{}}}),Ke=$({...De()},"VStepperWindowItem"),Y=R()({name:"VStepperWindowItem",props:Ke(),setup(e,y){let{slots:t}=y;return D(()=>{const a=le.filterProps(e);return l(le,q({_as:"VStepperWindowItem"},a,{class:["v-stepper-window-item",e.class],style:e.style}),t)}),{}}}),Qe=$({altLabels:Boolean,bgColor:String,completeIcon:P,editIcon:P,editable:Boolean,errorIcon:P,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,..._e()},"Stepper"),et=$({...Qe(),...Fe({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...Ge(),...he(ue(),["prevText","nextText"])},"VStepper"),tt=R()({name:"VStepper",props:et(),emits:{"update:modelValue":e=>!0},setup(e,y){let{slots:t}=y;const{items:a,next:u,prev:s,selected:o}=je(e,J),{displayClasses:d,mobile:p}=oe(e),{completeIcon:n,editIcon:m,errorIcon:w,color:I,editable:j,prevText:V,nextText:k}=ke(e),r=b(()=>e.items.map((g,N)=>{const E=Q(g,e.itemTitle,g),O=Q(g,e.itemValue,N+1);return{title:E,value:O,raw:g}})),i=b(()=>a.value.findIndex(g=>o.value.includes(g.id))),h=b(()=>e.disabled?e.disabled:i.value===0?"prev":i.value===a.value.length-1?"next":!1);return ge({VStepperItem:{editable:j,errorIcon:w,completeIcon:n,editIcon:m,prevText:V,nextText:k},VStepperActions:{color:I,disabled:h,prevText:V,nextText:k}}),D(()=>{const g=ne.filterProps(e),N=!!(t.header||e.items.length),E=e.items.length>0,O=!e.hideActions&&!!(E||t.actions);return l(ne,q(g,{color:e.bgColor,class:["v-stepper",{"v-stepper--alt-labels":e.altLabels,"v-stepper--flat":e.flat,"v-stepper--non-linear":e.nonLinear,"v-stepper--mobile":p.value},d.value,e.class],style:e.style}),{default:()=>{var X,Z;return[N&&l(ce,{key:"stepper-header"},{default:()=>[r.value.map((B,G)=>{let{raw:z,...K}=B;return v(T,null,[!!G&&l(Ne,null,null),l(U,K,{default:t[`header-item.${K.value}`]??t.header,icon:t.icon,title:t.title,subtitle:t.subtitle})])})]}),E&&l(de,{key:"stepper-window"},{default:()=>[r.value.map(B=>l(Y,{value:B.value},{default:()=>{var G,z;return((G=t[`item.${B.value}`])==null?void 0:G.call(t,B))??((z=t.item)==null?void 0:z.call(t,B))}}))]}),(X=t.default)==null?void 0:X.call(t,{prev:s,next:u}),O&&(((Z=t.actions)==null?void 0:Z.call(t,{next:u,prev:s}))??l(qe,{key:"stepper-actions","onClick:prev":s,"onClick:next":u},t))]}})}),{prev:s,next:u}}}),at={class:"d-flex justify-center inner fill-height"},lt={class:"mb-5 text-h5"},nt={class:"text-grey-darken-1"},st={class:"d-flex justify-end mt-4"},rt={class:"text-center text-h3"},ot={class:"d-flex justify-center mt-8"},Vt={__name:"CreationForm",props:{title:{type:String,default:""},steps:{type:Array,default:()=>[]},summarySections:{type:Array,default:()=>[]},getVFormRef:{type:Function,default:null},formGetter:{type:Function,default:null},validateObject:{type:Function,default:null}},emits:["close","create","validationError"],setup(e,{expose:y,emit:t}){const{smAndDown:a}=oe(),u=xe(),s=e,o=H(1),d=H(!1),p=H(),n=t,{$gettext:m}=se();async function w(){await p.value.open(m("Warning"),m("If you close this form now, your modifications won't be saved. Do you confirm?"),{color:"warning",agreeLabel:m("Yes"),cancelLabel:m("No")})&&n("close")}async function I(V,k){const r=s.getVFormRef(s.steps[V-1]);if(r!==void 0){const{valid:i}=await r.validate();if(!i)return;if(s.validateObject)try{await s.validateObject(V)}catch(h){n("validationError",V,h.response.data);return}}o.value=k}function j(){d.value=!0,n("create")}return y({working:d}),(V,k)=>(S(),W("div",at,[l(tt,{modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=r=>o.value=r),mobile:!_(a)},{default:c(()=>[l(_(me),{ref_key:"confirm",ref:p},null,512),l(ce,{class:"align-center px-10"},{default:c(()=>[l(Le,{src:_(u).CREATION_FORM_LOGO_PATH,"max-width":"190",class:"hidden-sm-and-down"},null,8,["src"]),(S(!0),W(T,null,L(e.steps,(r,i)=>(S(),C(U,{key:r.name,color:"primary",value:i+1,complete:o.value>i+1},{default:c(()=>[x(f(r.title),1)]),_:2},1032,["value","complete"]))),128)),l(U,{value:e.steps.length+1},{default:c(()=>[x(f(_(m)("Summary")),1)]),_:1},8,["value"]),l(A,{icon:"mdi-close",color:"primary",size:_(a)?"small":"x-large",variant:"text",onClick:w},null,8,["size"])]),_:1}),l(de,{class:"mt-4 d-flex justify-center"},{default:c(()=>[(S(!0),W(T,null,L(e.steps,(r,i)=>(S(),C(Y,{key:r.name,value:i+1,class:"flex-grow-1 ma-10"},{default:c(()=>[l(Ee,{fluid:""},{default:c(()=>[l(ie,{align:"center",justify:"center"},{default:c(()=>[l(F,{cols:"8",align:"start"},{default:c(()=>[v("div",lt,[v("span",nt,f(e.title),1),x(" / "+f(r.title),1)]),M(V.$slots,`form.${r.name}`,{step:r,currentStep:i+1})]),_:2},1024)]),_:2},1024)]),_:2},1024),v("div",st,[i+1>1?(S(),C(A,{key:0,class:"mr-10",variant:"text",onClick:h=>o.value=i},{default:c(()=>[x(f(_(m)("Back")),1)]),_:2},1032,["onClick"])):re("",!0),l(A,{color:"primary",size:"large",onClick:h=>I(i+1,i+2)},{default:c(()=>[x(f(_(m)("Next")),1)]),_:2},1032,["onClick"])])]),_:2},1032,["value"]))),128)),l(Y,{value:e.steps.length+1,class:"flex-grow-0"},{default:c(()=>[v("div",rt,f(_(m)("Summary")),1),l(Ye,{sections:e.summarySections,onModifyStep:k[0]||(k[0]=r=>o.value=r)},we({_:2},[L(V.$slots,(r,i)=>({name:i,fn:c(h=>[M(V.$slots,i,Ie(Ce(h)))])}))]),1032,["sections"]),v("div",ot,[l(A,{color:"primary",size:"large",loading:d.value,onClick:j},{default:c(()=>[x(f(_(m)("Confirm and create")),1)]),_:1},8,["loading"])])]),_:3},8,["value"])]),_:3})]),_:3},8,["modelValue","mobile"])]))}};export{Vt as _};
